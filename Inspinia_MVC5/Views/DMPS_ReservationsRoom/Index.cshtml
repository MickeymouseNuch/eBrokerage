@* ----------------------------------------------------Is Head Page List-------------------------------------------------------------- *@
<div class="row wrapper border-bottom white-bg page-heading" style="padding-bottom:5px">
    <div class="col-lg-8" style="padding-top:5px">
        <h3 style="margin-bottom:5px"><label id="application"></label></h3>
        <ol class="breadcrumb">
            <li>
                <a id="Back2Menu" data-url-back="'@Url.Action("ViewName","ControllerName")'" href="#"><label id="menu"></label></a>
            </li>
            <li class="active">
                <strong><label id="submenu"></label></strong>
            </li>
        </ol>
    </div>
    <div class="col-lg-4">
        <div class="title-action" style="padding-top:15px">
            @*<button id="btnAddNew" data-id="0" data-no="0" class="btn btn-primary"><i class="fa fa-file-text"></i>&nbsp;&nbsp; Add New Document</button>*@
        </div>
    </div>
</div>

@* ----------------------------------------------------------------------------------------------------------------------------------- *@


@* ----------------------------------------------------Is Searching Tab--------------------------------------------------------------- *@
<div class="wrapper wrapper-content" style="padding-bottom: 0px;">
    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>Search</h5>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                            <i class="fa fa-wrench"></i>
                        </a>
                        <a class="close-link">
                            <i class="fa fa-times"></i>
                        </a>
                    </div>
                </div>
                <div class="ibox-content">
                    <table>
                        <tbody>
                            <tr>
                                <td style="width: 270px; "></td>
                                <td style="text-align:right"><label style="padding-bottom: 10px;padding-top: 15px;">ประเภทห้อง : </label></td>
                                <td style="width:10px"></td>
                                <td style="width: 200px;">
                                    <div>
                                        @Html.DropDownList("ddlUnitType", null, "Please Select", new { @class = "select2_ddlUnitType form-control", style = "width:100%" })
                                    </div>
                                </td>

                                <td style="width:50px"></td>
                                <td style="text-align:right"><label style="padding-bottom: 10px;padding-top: 15px;">สถานะ  : </label></td>
                                <td style="width:10px"></td>
                                <td style="width: 200px;">
                                    <div>
                                        @Html.DropDownList("ddlUnitStatus", null, "Please Select", new { @class = "select2_ddlUnitStatus form-control", style = "width:100%" })
                                    </div>
                                </td>
                                <td style="width:10px"></td>
                                <td style="text-align:right"><label style="padding-bottom: 10px;padding-top: 15px;">ค้นหาวันที่ </label></td>
                                <td style="width:10px"></td>
                                <td>
                                    <input type="checkbox" id="chkDate" name="chkDate" class="chkDate" style="transform: scale(1.5); margin-left: 10px;">&nbsp;&nbsp;
                                </td>
                                <td style="width:10px"></td>
                                <td><button type="button" id="btnSearch" class="btn btn-primary"><i class="fa fa-search"></i>&nbsp;&nbsp; Search</button></td>
                            </tr>
                            <tr>
                                <td>
                                    <br />
                                </td>
                            </tr>
                            <tr id="DateSearch" style="display:none">
                                <td style="width:80px"></td>
                                <td style="text-align:right"><label style="padding-bottom: 10px;">Start Date : </label></td>
                                <td style="width:10px"></td>
                                <td>
                                    <div class="form-group" id="data_1">
                                        <div class="input-group date">
                                            <input id="StartDate" type="text" class="form-control" value="@System.DateTime.Now.ToString("01/01/yyyy")"><span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                        </div>
                                    </div>
                                </td>
                                <td style="width:50px"></td>
                                <td style="text-align:right"><label>End Date : </label></td>
                                <td style="width:10px"></td>
                                <td>
                                    <div class="form-group" id="data_1">
                                        <div class="input-group date">
                                            <input id="EndDate" type="text" class="form-control" value="@System.DateTime.Now.ToString("31/12/yyyy")"><span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                        </div>
                                    </div>
                                </td>
                                @*<td style="padding-bottom: 10px; padding-left: 24px; display: none;">
                                    <div id="showRRshop">
                                        <input type="checkbox" id="chkRRShop" name="chkRRShop" class="chkRRShop" style="transform: scale(1.5);">&nbsp;&nbsp;
                                        <label style="padding-top: 5px;"> SHOP </label>
                                    </div>
                                </td>*@
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


<!--model dialog-->

<div class="modal" tabindex="-1" id="UploadModal" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="width:800px;margin:30px  auto">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">x</span>
                </button>
            </div>
            <div class="modal-body">
                <div style="padding-top:3px ; margin-bottom:10px">
                    <div class="row">
                        <div class="col-md-10col-md-offset-1 col-xs-12">
                            <table id="tableReservationsRec" style="width:100%">
                                <thead>
                                    <tr style="font-size: 15px;">
                                        @*<td style="padding-left: 1px; padding-bottom: 10px; "></td>*@
                                        <td style="padding-left: 10px; padding-bottom: 10px; text-align: center; border-bottom: solid 1px #efefef; ">ไฟล์เอกสาร</td>
                                        <td style="padding-left: 10px; padding-bottom: 10px; text-align: center; border-bottom: solid 1px #efefef;">ผู้อัพโหลด</td>
                                        <td style="padding-left: 10px; padding-bottom: 10px; text-align: center; border-bottom: solid 1px #efefef;">วันที่</td>
                                        <td style="padding-left: 10px; padding-bottom: 10px; border-bottom: solid 1px #efefef;"></td>
                                        <td style="padding-left: 10px; padding-bottom: 10px; border-bottom: solid 1px #efefef;"></td>
                                    </tr>
                                </thead>
                                <tbody id="tbody2Reservations"></tbody>
                            </table>
                            <div id="load" style="display:none ;text-align:center ; margin: 15px;font-size:15px">
                                Please wait...
                                <img src="//s.svgbox.net/loaders.svg?fill=maroon&ic=tail-spin" style="width:24px">
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <br />
                    <input type="hidden" id="txtRVID" />
                    <input id="ReservationsFileUpload" name="FileUpload" style="font-size: 15px; margin-left:7px" type="file" accept="image/png, image/jpeg,.pdf"><br />
                    <p style="margin-left: 7px; margin-top: -15px; margin-bottom: 15px; color: red ; font-size: 12px; "> *เฉพาะไฟล์ .pdf, .png, .jpeg (ขนาดไฟล์ไม่เกิน 5 MB ) </p>
                    &nbsp;
                    <input id="insertNewFile" style="font-size: 15px;color:black" type="submit" value="เพิ่มไฟล์">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="btnHistory" style="margin: 1px;" class="btnHistory">
                    <i class="fa fa-history" style="font-size:24px;margin-right:10px"></i><font style="top: -5px;position: relative;">ประวัติ</font>
                </button>
            </div>
        </div>
    </div>
</div>


<!--History model dialog-->
<div class="modal" tabindex="-1" id="HistoryModel" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="width:1000px;margin:10px  auto">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" id="HistoryClose">
                    <span aria-hidden="true">x</span>
                </button>
            </div>
            <div class="modal-body">
                <div style="padding-top: 3px; margin-bottom: 10px; height: 600px; overflow-y: auto; overflow-x: hidden; ">
                    <div class="row">
                        <div class="col-md-10col-md-offset-1 col-xs-12">
                            <table id="tableReservationsHistoryRec" style="width:100%">
                                <thead>
                                    <tr style="font-size: 15px;">
                                        <td style="padding: 8px; background: lightgray; color: black; border-top-left-radius: 10px; border-bottom-left-radius: 10px; text-align: center; border-bottom: solid 1px #efefef;">ไฟล์เอกสาร</td>
                                        <td style="padding: 8px; background: lightgray; color: black; text-align: center; border-bottom: solid 1px #efefef; ">ประเภท</td>
                                        <td style="padding: 8px; background: lightgray; color: black; border-top-right-radius: 10px; border-bottom-right-radius: 10px; text-align: center; border-bottom: solid 1px #efefef; ">ผู้แก้ไขเอกสาร</td>
                                    </tr>
                                </thead>
                                <tbody id="tbody2HistoryRS"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

<!--CancelForm model dialog-->
<div class="modal" tabindex="-1" id="CancelFormModel" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="width: 40pc; height: 30pc; margin-left: 30pc; overflow-x: hidden; overflow-y: hidden; "> 
    <div class="modal-dialog" style="margin:10px  auto">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" id="CancelFormClose">
                    <span aria-hidden="true">x</span>
                </button>
            </div>
            <div class="modal-body">
                <div style="padding-top: 3px; margin-bottom: 10px;">
                    <div class="row">
                        <div class="row">
                            <div class="col-lg-8" style="text-align: left; margin-left: 24px;">
                                <h3>ยกเลิกหนังสือจองเช่าห้องชุด</h3>
                                <p id="CF_DepositID" hidden></p>
                                <p id="CF__DSContactID" hidden></p>
                                <p id="CF_UnitID" hidden></p>
                                <p id="CF_RentID" hidden></p>

                            </div>
                        </div>
                        <br />
                        <div class="row" style="margin-left: 16px">
                            <div class="col-lg-2" style="text-align:right">
                                <label id="lbl" class="" style="padding-top: 5px; font-size: 12px;">สาเหตุ : <label for="lblColor" id="lblColor" style="color:red"> *</label></label>
                            </div>
                            <div class="col-lg-8">
                                @Html.DropDownList("ddl_ReasonCancel", null, null, new { @class = "select2_ReasonCancel form-control", style = "width:100%", multiple = "multiple" })
                            </div>
                        </div>
                        <br />
                        <div class="row" style="margin-left: 16px">
                            <div id="dvReasonCancel" class="col-lg-2" style="text-align:right" hidden>
                                <label class="" style="padding-top: 5px; font-size: 12px;">ระบุ : <label for="lblColor" id="lblColor" style="color:red"> *</label></label>
                            </div>
                            <div class="col-lg-8">
                                <input type="text" id="txtReasonCancelOther" name="txtReasonCancelOther" style="display:none" class="form-control " data-id="" value="" maxlength="50000" />
                            </div>
                        </div>
                        <br />
                        <div class="row" style="margin-left: 16px">
                            <div class="col-lg-2" style="text-align:right">
                                <label id="lbl" class="" style="padding-top: 5px ;font-size: 11px;">หมายเหตุ : <label for="lblColor" id="lblColor" style="color:red"> *</label></label>
                            </div>
                            <div class="col-lg-8">
                                <textarea id="text_RemakCancel" class="form-control" rows="3"></textarea>
                            </div>
                        </div>
                        <br />
                        <div class="row" style="margin-left: 16px">
                            <div class="col-lg-2" style="text-align:right">
                                <label id="lbl" class="" style="padding-top: 5px ;font-size: 11px;">ผู้รับเรื่อง : <label for="lblColor" id="lblColor" style="color:red"> *</label></label>
                            </div>
                            <div class="col-lg-8">
                                @Html.DropDownList("ddlSaleName", null, "Please Select", new { @class = "select2_ddlSaleName form-control", style = "width:100%" })
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row" id="" style="">
                    <div id="" class="col-lg-12" style="text-align:right">
                        <button type="button" id="btnDeleteForm" class="btn btn-primary right"><i class="fa fa-save"></i>&nbsp;&nbsp;ยืนยันการยกเลิก</button>
                        <button type="button" id="btnCloseForm" class="btn btn-default-close" data-id=""><i class="fa fa-close"></i>&nbsp;&nbsp;ปิด</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@*<input type="text" id="RowSelected" value="" />*@
@*<input type="text" id="RowSelected" value="" hidden="hidden" />*@
@* ----------------------------------------------------------------------------------------------------------------------------------- *@

@* ----------------------------------------------------Is DataList Tab---------------------------------------------------------------- *@
<div id="DataListView"></div>
@* ----------------------------------------------------------------------------------------------------------------------------------- *@

@* ------------------------------------------------------Is Modal Tab----------------------------------------------------------------- *@
@Html.Partial("LoadModal")
@Html.Partial("LoadModalRent")
@Html.Partial("LoadModalResale")
@* ----------------------------------------------------------------------------------------------------------------------------------- *@




@*----------------------- Import CSS---------------------- *@
@Styles.Render("~/plugins/footableStyles")
@Styles.Render("~/Content/plugins/dataTables/dataTablesStyles")
@Styles.Render("~/plugins/select2Styles")
@Styles.Render("~/plugins/dataPickerStyles")
@Styles.Render("~/plugins/sweetAlertStyles")
@Styles.Render("~/Content/plugins/iCheck/iCheckStyles")
@*-------------------------------------------------------- *@

@*------------------ Import JavaScript-------------------- *@
@Scripts.Render("~/plugins/footable")
@Scripts.Render("~/plugins/dataTables")
@Scripts.Render("~/plugins/select2")
@Scripts.Render("~/plugins/dataPicker")
@Scripts.Render("~/plugins/sweetAlert")
@Scripts.Render("~/plugins/iCheck")
@*-------------------------------------------------------- *@

<script src="~/Scripts/Main/JS_Main.js?0"></script>
<script src="~/Scripts/Main/Utility.js?2"></script>
<script src="~/Scripts/Main/date.format.js?0"></script>

<script src="~/waitMe/waitMe.min.js?0"></script>
<link href="~/waitMe/waitMe.min.css?0" rel="stylesheet" />

<div hidden="hidden">
    <input type="text" id="controlDupplicate" value="0" hidden />
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $('#data_1 .input-group.date').datepicker({
            todayBtn: "linked",
            keyboardNavigation: false,
            forceParse: false,
            calendarWeeks: true,
            autoclose: true,
            format: 'dd/mm/yyyy'
        });

        $('.i-checks').iCheck({
            checkboxClass: 'icheckbox_square-green',
            radioClass: 'iradio_square-green',
        });

        $(".allownumericwithoutdecimal").on("keypress keyup blur", function (event) {
            $(this).val($(this).val().replace(/[^\d].+/, ""));
            if ((event.which < 48 || event.which > 57)) {
                event.preventDefault();
            }
        });

        function formatNumber(num) {
            return num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,")
        }

        $(document).delegate('.numbersOnly', 'keypress', function (e) {
            if (String.fromCharCode(e.keyCode).match(/[^0-9\.\,]/g)) return false;
        });

        $(document).delegate('.numbersOnly', 'focusout', function () {
            var IsVal = parseFloat($(this).val().replace(/\,/g, ''));
            if (isNaN(IsVal)) { IsVal = 0; }
            $(this).val(ConvertString2DecimalFormat(IsVal.toFixed(2)));
        });

        $(".select2_Bank,.select2_AccountType,.select2_RentType,.select2_Developer,.select2_Project,.select2_Provice,.select2_Distict,.select2_SubDistinct,.select2_CardFrom,.select2_UnitType,.select2_CashierBank,.select2_RNBank,.select2_RNCardFrom,.select2_RNProvice,.select2_RNDistict,.select2_RNSubDistinct,.select2_RNRentType,.select2_RNDeveloper,.select2_RNProject,.select2_RNUnitType,.select2_RSBank,.select2_RSRentType,.select2_RSDeveloper,.select2_RSProject,.select2_RSUnitType,.select2_RSCardFrom,.select2_RSProvice,.select2_RSDistict,.select2_RSSubDistinct,.select2_RNCashierBank,.select2_RSCashierBank,.select2_ReasonCancel").select2();
        $('.select2_ddlSaleName').select2();
        $('.select2-container').css("z-index", "auto");

        $('#ddl_Bank').attr("disabled", true);
        $('#ddlDistrict').attr("disabled", false);
        $('#ddlSubDistrict').attr("disabled", false);

        $('#ddl_RentType').attr("disabled", true);
        $('#ddl_Developer').attr("disabled", true);
        $('#ddl_Project').attr("disabled", true);
        $('#txtFloor').attr("disabled", true);
        $('#txtUnits').attr("disabled", true);
        $('#txtAddressNo').attr("disabled", true);
        $('#ddlDS_UnitType').attr("disabled", true);
        $('#txtRoomArea').attr("disabled", true);
        $('#txtRoomAddress').attr("disabled", true);
        $('#txtBuilding').attr("disabled", true);

        $('#ddlDueDateSignContact').attr("disabled", true);
        $('#dllContractSdate').attr("disabled", true);
        $('#dllContractEdate').attr("disabled", true);
        $('#dllContractSdate').attr("disabled", true);
        $('#dllCashierDate').attr("disabled", true);
        $('#dllCashTransferDate').attr("disabled", true);
        $('#ddlDocDate').attr("disabled", true);


        $('#ddl_RNRentType').attr("disabled", true);
        $('#ddl_RNDeveloper').attr("disabled", true);


        $('#ddl_RNProject').attr("disabled", true);
        $('#txt_RNFloor').attr("disabled", true);
        $('#txt_RNUnits').attr("disabled", true);
        $('#txt_RNAddressNo').attr("disabled", true);
        $('#ddl_RNDS_UnitType').attr("disabled", true);
        $('#txt_RNBuilding').attr("disabled", true);
        $('#txt_RNRoomAddress').attr("disabled", true);

        $('#ddl_RNBank').attr("disabled", true);
        $('#txt_RNRoomArea').attr("disabled", true);

        $('#ddl_RSBank').attr("disabled", true);
        $('#ddl_RSRentType').attr("disabled", true);
        $('#ddl_RSDeveloper').attr("disabled", true);
        $('#ddl_RSProject').attr("disabled", true);
        $('#txt_RSFloor').attr("disabled", true);
        $('#txt_RSUnits').attr("disabled", true);
        $('#txt_RSAddressNo').attr("disabled", true);
        $('#ddl_RSDS_UnitType').attr("disabled", true);
        $('#txt_RSRoomArea').attr("disabled", true);
        $('#txt_RSBuilding').attr("disabled", true);
        $('#txt_RSRoomAddress').attr("disabled", true);

        $('#ddlRSDocDate').attr("disabled", true);
        $('#ddl_RSCus_CardDate').attr("disabled", true);
        $('#ddl_RSCus_CardExpire').attr("disabled", true);
        $('#dllDueTransfer').attr("disabled", true);


        var CheckRV_RSSave = 0;
        var CheckRV_RNSave = 0;
        var Check_Save = 0;

        $('#txtReserve_RentPrice').keyup(function (event) {
            // skip for arrow keys
            if (event.which >= 37 && event.which <= 40) {
                event.preventDefault();
            }

            var currentVal = $(this).val();
            var testDecimal = testDecimals(currentVal);
            if (testDecimal.length > 1) {
                console.log("You cannot enter more than one decimal point");
                currentVal = currentVal.slice(0, -1);
            }
            $(this).val(replaceCommas(currentVal));
        });


            $('#txtReserve_InsuranceAmte').keyup(function (event) {
                // skip for arrow keys
                if (event.which >= 37 && event.which <= 40) {
                    event.preventDefault();
                }

                var currentVal = $(this).val();
                var testDecimal = testDecimals(currentVal);
                if (testDecimal.length > 1) {
                    console.log("You cannot enter more than one decimal point");
                    currentVal = currentVal.slice(0, -1);
                }
                $(this).val(replaceCommas(currentVal));
            });

                $('#txtReserve_Deposit').keyup(function (event) {
                    // skip for arrow keys
                    if (event.which >= 37 && event.which <= 40) {
                        event.preventDefault();
                    }

                    var currentVal = $(this).val();
                    var testDecimal = testDecimals(currentVal);
                    if (testDecimal.length > 1) {
                        console.log("You cannot enter more than one decimal point");
                        currentVal = currentVal.slice(0, -1);
                    }
                    $(this).val(replaceCommas(currentVal));
                });

                    $('#txtReserve_Amt').keyup(function (event) {
                        // skip for arrow keys
                        if (event.which >= 37 && event.which <= 40) {
                            event.preventDefault();
                        }

                        var currentVal = $(this).val();
                        var testDecimal = testDecimals(currentVal);
                        if (testDecimal.length > 1) {
                            console.log("You cannot enter more than one decimal point");
                            currentVal = currentVal.slice(0, -1);
                        }
                        $(this).val(replaceCommas(currentVal));
                    });

                        $('#txtReserve_AmounCashTransfer').keyup(function (event) {
                            // skip for arrow keys
                            if (event.which >= 37 && event.which <= 40) {
                                event.preventDefault();
                            }

                            var currentVal = $(this).val();
                            var testDecimal = testDecimals(currentVal);
                            if (testDecimal.length > 1) {
                                console.log("You cannot enter more than one decimal point");
                                currentVal = currentVal.slice(0, -1);
                            }
                            $(this).val(replaceCommas(currentVal));
                        });

                            $('#txtReserve_AmountCashier').keyup(function (event) {
                                // skip for arrow keys
                                if (event.which >= 37 && event.which <= 40) {
                                    event.preventDefault();
                                }

                                var currentVal = $(this).val();
                                var testDecimal = testDecimals(currentVal);
                                if (testDecimal.length > 1) {
                                    console.log("You cannot enter more than one decimal point");
                                    currentVal = currentVal.slice(0, -1);
                                }
                                $(this).val(replaceCommas(currentVal));
                            });

                                $('#txtReserve_AmountCash').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });


                                $('#txtReserve_ResalePrice').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });

                                $('#txtReserve_ResalePricePerSQM').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });

                                $('#txtReserve_RSContactAmount').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });


                                $('#txtReserve_ResaleRemainPrice').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });


                                $('#txtReserve_ResaleAmount').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });

                                $('#txtReserve_RNAmountCash').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });

                                $('#txtReserve_RNAmountCashier').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });

                                $('#txtReserve_RNAmounCashTransfer').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });

                                $('#txtTransferFeeAmt').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });


                                $('#txt_RSSalePrice').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });

                                $('#txt_RSSaleDiscount').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });

                                $('#txt_RSTranferDiscount').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });

                                $('#txt_RSNetPrice').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });

                                $('#txt_RSPricePerSQM').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });

                                $('#txt_RSPriceBeforeVat').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });

                                $('#txt_RSVat').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });


                                $('#txt_RSPriceIncVat').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });


                                $('#txtContactAmt').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });

                                $('#txtReserve_RSAmountCash').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });


                                $('#txtReserve_RSAmountCashier').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });


                                $('#txtReserve_RSAmounCashTransfer').keyup(function (event) {
                                    // skip for arrow keys
                                    if (event.which >= 37 && event.which <= 40) {
                                        event.preventDefault();
                                    }

                                    var currentVal = $(this).val();
                                    var testDecimal = testDecimals(currentVal);
                                    if (testDecimal.length > 1) {
                                        console.log("You cannot enter more than one decimal point");
                                        currentVal = currentVal.slice(0, -1);
                                    }
                                    $(this).val(replaceCommas(currentVal));
                                });


        //$('#DataListView').on("click", ".confirm-Print", function () {
        //    var id = $(this).data("rntid");
        //    var _FurAmt = $(this).data("furamt");

        //    OutReport(id);

        //    if (_FurAmt != 0) { PrintReportFurniture(id); }




        //});

        //$('#DataListView').on("click", ".confirm-Copy", function () {
        //    //var id = $(this).data("rntid");
        //    //CopyRentContactOld(id);
        //    var _DepositID = $(this).data("dsid");
        //    var _DSContactID = $(this).data("cust");
        //    var _UnitID = $(this).data("uid");
        //    var _RentID = $(this).data("rntid");

        //    $('#lblHeader').text("รายละเอียดสัญญาเช่าห้องชุด (ต่อสัญญาลูกค้าคนเดิม)")
        //    ShowModalBlinding(_DepositID, _DSContactID, _UnitID, _RentID, "",1);
        //});


        function OutReportRN(id) {
            //var url = '@Url.Action("PrintReport", "DMPS_ReleaseRoom")' + "?ReportID=" + id;
            //window.open(url, '_blank');
            var url = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RN_2020_Contact" + "&objName=" + "RentID" + "&objValue=" + id;
            loadNewPage(url);
        }


        function PrintReportFurniture(id) {
            var url = '@Url.Action("PrintReportFurniture", "DMPS_ReleaseRoom")' + "?ReportID=" + id;
            window.open(url, '_blank');
        }


        //confirm - Print - rept - update

        $('#DataListView').on("click", ".confirm-Print", function () {
            var _ReservationsID = $(this).data('rvtid');
            var _RVType = $(this).data('rvtype');


            if (_RVType == 2) {

                var url1 = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RV_RENT_2020_Contact" + "&objName=" + "ReservationsID" + "&objValue=" + _ReservationsID;
            loadNewPage(url1);

            @*setTimeout(function () {
                var url2 = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RV_RENT_Temp_Reciept_001" + "&objName=" + "ReservationsID" + "&objValue=" + _ReservationsID;
                loadNewPage(url2);
            }, 800);*@

            }

            if (_RVType == 3) {

                var url1 = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RV_RESALE_Contact" + "&objName=" + "RVID" + "&objValue=" + _ReservationsID;
                loadNewPage(url1);

                setTimeout(function () {
                    var url2 = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RV_RESALE_Temporary_Reciept" + "&objName=" + "ReservationsID" + "&objValue=" + _ReservationsID;
                    loadNewPage(url2);
                }, 2000);

            }


            @*var url1 = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RV_RENT_CONTACT_001" + "&objName=" + "ReservationsID" + "&objValue=" + _ReservationsID;
            loadNewPage(url1);


            var url2 = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RV_RENT_Temp_Reciept_001" + "&objName=" + "ReservationsID" + "&objValue=" + _ReservationsID;
            loadNewPage(url2);*@
        });

        $('#DataListView').on("click", ".confirm-PrintShop", function () {
            var _ReservationsID = $(this).data('rvtid');

            var url = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RV_RENT_CONTACT_Shop" + "&objName=" + "ReservationsID" + "&objValue=" + _ReservationsID;
            loadNewPage(url);

        });

        //cancel-form to load report
        $('#DataListView').on("click", ".confirm-trashForm", function () {
            var _ReservationsID = $(this).data('rvtid');

            var url = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RV_CancelForm" + "&objName=" + "ReservationsID" + "&objValue=" + _ReservationsID;
            loadNewPage(url);

        });


        //$('#DataListView').on("click", ".confirm-New", function () {
        //    var _DepositID = $(this).data("dsid");
        //    var _DSContactID = $(this).data("cust");
        //    var _UnitID = $(this).data("uid");
        //    var _RentID = $(this).data("rntid");

        //    $('#lblHeader').text("รายละเอียดสัญญาเช่าห้องชุด (ทำสัญญาใหม่)")

        //    ShowModalBlinding(_DepositID, _DSContactID, _UnitID, _RentID, "Exist",0);
        //});

        $('#DataListView').on("click", ".confirm-View", function () {
            CheckSave = 0;
            var _DepositID = $(this).data("dsid");
            var _DSContactID = $(this).data("cust");
            var _UnitID = $(this).data("uid");
            var _RentID = $(this).data("rvtid");
            //LoadShopDateils($(this).data("rvtid"));
            //alert('DS' + _DepositID + ': Contract' + _DSContactID + ': Unit' + _UnitID + ': RentID' + _RentID);
            $('#lblHeader').text("รายละเอียดสัญญาเช่าห้องชุด")
            $('#btnSave').attr("disabled", false);


            $("#txtNameShop").val("");
            $("#txtAimShop").val("");
            //!$("#rdo1").is(':checked');
            //!$("#rdo2").is(':checked');
            //!$("#type1").is(':checked');
            //!$("#type2").is(':checked');
            $('#rdo2').prop('checked', false).trigger('change');
            $('#rdo1').prop('checked', false).trigger('change');
            $('#txtcommittee').val("");
            $("#showNameShop").val("");
            $("#showAimShop").val("");
            $('#type1').prop('checked', false).trigger('change');
            $('#type2').prop('checked', false).trigger('change');
            $('displaycommittee').val("");
            ShowModalBlinding(_DepositID, _DSContactID, _UnitID, _RentID, "", 0);
        });


        $('#DataListView').on("click", ".confirm-New", function () {
            var _DepositID = $(this).data("dsid");
            var _DSContactID = $(this).data("cust");
            var _UnitID = $(this).data("uid");
            var _RVID = $(this).data("rvtid");

            var _UnitStatus = $(this).data("rvst");
            var _rvcust = $(this).data("rvcust");

            //alert('DS' + _DepositID + ': Contract' + _DSContactID + ': Unit' + _UnitID + ': RentID' + _RentID);

            //$('#btnSave').attr("disabled", false);

            //alert(_UnitStatus)
            if (_UnitStatus == 4) {
                //$('#myModalRent').modal('show');

                ShowModalBlindingRent(_DepositID, _DSContactID, _UnitID, 0, _RVID, _rvcust);
            };
            if (_UnitStatus == 6) {
                //$('#myModalResale').modal('show');
                //_DepositID, _DSContactID, _UnitID, _ReSaleID

                ShowModalBlindingResale(_DepositID, _DSContactID, _UnitID, 0, _RVID, _rvcust);
            };
        });

        $('#DataListView').on("click", ".confirm-UploadDS", function () {
            var _ReservationsID = $(this).data('rvtid');

            $("#txtRVID").val(_ReservationsID);
            LoadData2UploadReservations(_ReservationsID);
            LoadDataHistory(_ReservationsID);
            $("#tbody2Reservations").empty();
            $("#ReservationsFileUpload").val("");
            $('#UploadModal').modal('show');

        });

        function LoadData2UploadReservations(_ReservationsID) {

                var url = '@Url.Action("LoadData2UploadReservations", "DMPS_ReservationsRoom")';

                $.post(url,
                    {
                        _ReservationsID: _ReservationsID,

                    }, function (result) {
                        var obj = $.parseJSON(result);

                        $("#tbody2Reservations").empty();

                        for (var i = 0; i < obj.length; i++) {

                            var dt = obj[i].RevisedDateTime;
                            var datef = dt.substr(6, 10);

                            var timestamp = datef * 1000;
                            var date = new Date(timestamp);
                            var df = date.format('dd/mm/yyyy');


                            var fp = obj[i].FilePath.replace(/^.*[\\\/]/, '');

                            $("#tableReservationsRec").append(
                                '<tr class="tr2Reservations" style="padding: 10px; border-bottom: solid 1px #efefef;text-align:center"><td class="tdReservationsAtid" style="padding: 10px; text-align: left;" hidden>' + obj[i].ReservationsAttachmentID
                                + '</td><td class="tdFilePath" style="padding: 10px; text-align: left;"><a name = "btnRSView"' + i + ' href="../' + obj[i].FilePath + '" target="_blank">' + fp
                                + '</a></td><td class="tdUser" style="padding: 10px; text-align: center;">' + obj[i].RevisedBy
                                + '</td><td class="tdDateTime" style="padding: 10px; text-align: center;">' + df
                                + '</td><td  name="tdButtDownload" class="tdButtDownload" style="padding-bottom: 10px;padding-top: 10px;" data-link="' + obj[i].FilePath + '"><button name ="btnDraftDocumentDownload"' + i + ' style="font-size:15px"><i class="fa fa-cloud-download"></i></button>'
                                + '</td><td  name="tdButtDel" class="tdButtDel" style="padding-bottom: 10px;padding-top: 10px;"><button name ="btnReservationsDel"' + i + ' style="font-size:15px"><i class="fa fa-trash-o"></i></button></td></tr>');

                        }

                         $('.tdButtDownload').click(function () {
                            var btnload = $(this).data("link");
                            var filename = encodeURIComponent(btnload);
                            var url = '@Url.Action("LoadDraftDocument", "DMPS_DraftDocument")?Filename=' + filename;
                            var a = document.createElement("a");
                            document.body.appendChild(a);
                            a.href = url;
                            a.download = btnload.replace(/^.*[\\\/]/, '') || "download-" + $.now()
                            a.click();

                             var ReservationsAttID = $(this).closest('tr.tr2Reservations').find('.tdReservationsAtid').html();
                             ReservationsAttachmentHistory(ReservationsAttID, 3);
                             LoadDataHistory(_ReservationsID);
                        });

                        $("[name^='btnReservationsDel']").click(function () {
                            var btn = $(this);
                            swal({
                                title: "ยืนยันการลบข้อมูล?",
                                text: "คุณต้องการลบข้อมูลนี้",
                                type: "warning",
                                showCancelButton: true,
                                confirmButtonColor: "#64dd54",
                                confirmButtonText: "Yes, Delete it!",
                                closeOnConfirm: true
                            }, function () {

                                var ReservationsAttID = btn.closest('tr.tr2Reservations').find('.tdReservationsAtid').html();
                                DeleteReservationsAttachments(ReservationsAttID);

                                var ReservationsFP = btn.closest('tr.tr2Reservations').find('a').attr('href');
                                DeleteReservationsFiltPath(ReservationsFP);

                                ReservationsAttachmentHistory(ReservationsAttID, 4);
                                LoadDataHistory(_ReservationsID);
                            });

                        });

                        $("[name^='btnRSView']").click(function () {
                            var btn = $(this);
                            var ReservationsAttID = btn.closest('tr.tr2Reservations').find('.tdReservationsAtid').html();
                            ReservationsAttachmentHistory(ReservationsAttID, 2);
                            LoadDataHistory(_ReservationsID);
                        });



                    });
        }

        function LoadDataHistory(_ReservationsID){
                var url = '@Url.Action("LoadDataHistory", "DMPS_ReservationsRoom")';

                $.post(url, {
                    _ReservationsID: _ReservationsID,

                }, function (result) {
                    var obj = $.parseJSON(result);

                    $("#tbody2HistoryRS").empty();

                    for (var i = 0; i < obj.length; i++) {

                        //Newtime Realtime
                        var dth = obj[i].RevisedDateTime;
                        var datefh = dth.substr(6, 10);

                        var timestamp = datefh * 1000;
                        var date = new Date(timestamp);
                        var dfh = date.format('dd/mm/yyyy');

                        var times = new Date(timestamp).toLocaleTimeString("en-GB")

                        //time at create
                        var dtc = obj[i].RevisedDateTime_create;
                        var dtcreate = dtc.substr(6, 10);

                        var timescreate = dtcreate * 1000;
                        var date = new Date(timescreate);
                        var dtcrate = date.format('dd/mm/yyyy');

                        var times_create = new Date(timescreate).toLocaleTimeString("en-GB")

                        //filepath
                        var fph = obj[i].FilePath.replace(/^.*[\\\/]/, '');

                        $("#tableReservationsHistoryRec").append(
                            '<tr class="tr2HistoryReservations"><td class="tdReservationsHistoryAtid" style="padding: 10px; text-align: left;" hidden>' + obj[i].ReservationsAttachmentID
                            + '</td><td class="tdHistoryFilepath" style="border-bottom: solid 1px #efefef; padding: 10px;"><font style="font-size: 15px; text-align: left;">' + fph
                            + '</font><br /><font style="font-size: 12px;color:gray; text-align: left;">โดย ' + obj[i].em_name_t_create + "  " + obj[i].em_surname_t_create + " เมื่อ " + dtcrate + " " + times_create
                            + '</font></td ><td class="tdHistoryStatus" style="font-size: 15px; padding: 10px; text-align: center; border-bottom: solid 1px #efefef;"><font style="font-size: 15px;"><button type="button" disabled>' + obj[i].StatusDescription
                            + '</button ></font></td><td class="tdHistoryName" style="border-bottom: solid 1px #efefef; text-align: center; padding: 10px;"><font style="font-size: 15px; ">' + obj[i].em_name_t + "  " + obj[i].em_surname_t
                            + '</font><br /><font style="font-size: 12px;color:gray; ">เมื่อ ' + dfh + " " + times
                            + '</font></td></tr >');

                    }
                })

            };

        /* loading*/
        $(document).ajaxSend(function () {
            $("#load").show();
        });

        $(document).ajaxComplete(function () {
            $('#load').hide();
        });

        /*/History click show/hide popup*/
        $("#btnHistory").click(function () {
            LoadDataHistory($("#txtRVID").val())
            $('#HistoryModel').modal('show');
            $('#UploadModal').modal('hide');
        });

        $("#HistoryClose").click(function () {
            $('#HistoryModel').modal('hide');
            $('#UploadModal').modal('show');
        });

        $("#CancelFormClose").click(function () {
            $('#CancelFormModel').modal('hide');
            $('#CancelFormModal').modal('show');
        });

        $("#chkDate").change(function () {
            var check = $("#chkDate").is(":checked");
            if (check) {
                $('#DateSearch').show();
            } else {
                $('#DateSearch').hide();
            }
        });

        /* เพิ่มไลฟ์*/
        $('#insertNewFile').click(function () {

            var msg = validate();
            if (msg != "") {
                swal({
                    title: "ผิดพลาด",
                    text: msg,
                    icon: "warning",
                    button: "Ok"
                });

            } else {
                swal({
                    title: "ยืนยันการบันทึกข้อมูล?",
                    text: "คุณต้องการบันทึกข้อมูลนี้",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#64dd54",
                    confirmButtonText: "Yes, Save it!",
                    closeOnConfirm: true
                }, function () {

                    var fileUpload = $("#ReservationsFileUpload").get(0);
                    var path = "Attachment/Reservations/" + $("#txtRVID").val() + "/";
                    var files = fileUpload.files;

                    UploadFile("ReservationsFileUpload", path);

                    // path = path + files[0].name;  //Decode url
                    AddReservationsAttachments();


                });

            }

        });

            function UploadFile(fluID, path) {
                if (window.FormData !== undefined) {

                    var fileUpload = $("#" + fluID).get(0);
                    var files = fileUpload.files;
                    // Create FormData object
                    var fileData = new FormData();

                    // Looping over all files and add it to FormData object
                    for (var i = 0; i < files.length; i++) {
                        //fileData.append(replaceFileName(files[i].name), files[i]);
                        fileData.append("file" + i, files[i]);
                    }

                    // Adding one more key to FormData object
                    fileData.append('key', fluID);
                    fileData.append('strPath', path);

                    return $.ajax({
                       // url: '/DMPS_DepositRoom/UploadFiles',
                        url: '@Url.Action("UploadFiles", "DMPS_ReservationsRoom")',
                        type: "POST",
                        contentType: false, // Not to set any content header
                        processData: false, // Not to process data
                        data: fileData,
                        success: function (result) {
                            return result
                        },
                        error: function (err) {
                            return "False";
                        }
                    });
                }
            }


            function validate() {
                var MAX_FILE_SIZE = 5 * 1024 * 1024; // 5MB
                var msg = "";

                for (var i = 0; i < $(".tdFilePath").length; i++) {
                    var FilePathName = $(".tdFilePath")[i].textContent;
                    if ($("#ReservationsFileUpload").val().replace(/^.*[\\\/]/, '') == FilePathName) {
                        msg = "ไฟล์นี้มีอยู่แล้ว";
                        break;
                    }

                }


            if ($("#ReservationsFileUpload").val().length == 0) {
                msg = "กรุณาเลือกไฟล์";
            }
            else if ($("#tableReservationsRec tr").length > 5) {
                msg = "เกินขีดจำกัดการเพิ่มไฟล์ กรุณาลบไฟล์ก่อนทำการเพิ่มไฟล์ใหม่";
            }
            else if ($("#ReservationsFileUpload")[0].files[0].size > MAX_FILE_SIZE) {
                msg = "ขนาดไฟล์เกิน 5 MB";
            }


            return msg;

        }



        function AddReservationsAttachments()
        {
            var url = '@Url.Action("AddReservationsAttachments", "DMPS_ReservationsRoom")';

            var emp_id = $("#EmpID").val();
            var Reservationsid = $("#txtRVID").val();
            var Reservationspath = "Attachment/Reservations/" + $("#txtRVID").val() + "/" + $("#ReservationsFileUpload").val().replace(/^.*[\\\/]/, '');

            $.post(url, {
                emp_id: emp_id,
                Reservationsid: Reservationsid,
                Reservationspath: Reservationspath,

            }, function (result) {
                var obj = $.parseJSON(result);
                var RSAH = obj.toString();

                var _ReservationsID = $("#txtRVID").val();
                LoadData2UploadReservations(_ReservationsID);

                $("#ReservationsFileUpload").val("");
                ReservationsAttachmentHistory(RSAH, 1);
                LoadDataHistory(_ReservationsID);
            });

        }


        function DeleteReservationsAttachments(ReservationsAttID)
        {
            var url = '@Url.Action("DeleteReservationsAttachments", "DMPS_ReservationsRoom")';

            var ReservationsAtid = ReservationsAttID;

            $.post(url, {
                ReservationsAtid: ReservationsAtid,

            }, function (result) {

                var _ReservationsID = $("#txtRVID").val();

                LoadData2UploadReservations(_ReservationsID);


            });

        }


        function DeleteReservationsFiltPath(ReservationsFP)
        {
            var url = '@Url.Action("DeleteReservationsFiltPath", "DMPS_ReservationsRoom")';

            var ReservationsFilePath = ReservationsFP;

            $.post(url, {
                ReservationsFilePath: ReservationsFilePath,

            }, function (result) {

            });

        }

        function ReservationsAttachmentHistory(ReservationsAttHistoryID, StatusID)
        {
            var url = '@Url.Action("ReservationsAttachmentHistory", "DMPS_ReservationsRoom")';

            var emp_id = $("#EmpID").val();
            var staID = StatusID;
            var RVAHID = ReservationsAttHistoryID;

            $.post(url, {
                RVAHID: RVAHID,
                emp_id: emp_id,
                staID: staID,

            }, function (result) {

            });

        }

        $('input[name="niti"]').change(function () {
            var check = $("#rdo2").is(":checked");
            if (check) {
                $('#txtNameRN').html('ชื่อบริษัท :');
                $('#txtIDCardRN').html('ทะเบียนนิติบุคคลเลขที่  :');
                $('#committee').show();
            } else {
                $('#txtNameRN').html('ชื่อ-สกุล :');
                $('#txtIDCardRN').html('เลขที่บัตรประชาชน :');
                $('#committee').hide();

            }
        });

        $('input[name="rdo"]').change(function () {
            var check = $("#type2").is(":checked");
            if (check) {
                $('#showNameRN').html('ชื่อบริษัท :');
                $('#showIDCardRN').html('ทะเบียนนิติบุคคลเลขที่  :');
                $('#showcommittee').show();
            } else {
                $('#showNameRN').html('ชื่อ-สกุล :');
                $('#showIDCardRN').html('เลขที่บัตรประชาชน :');
                $('#showcommittee').hide();

            }
        });

        $('#btn_RSSave').click(function () {
            if (CheckRV_RSSave == 0) {

                swal({
                    title: "Are you sure?",
                    text: "Would you like to Save this record?",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "Yes, Cancel it!",
                    cancelButtonText: "Close",
                    closeOnConfirm: false

                }, function (isConfirm) {
                    if (isConfirm == true) {

                        ShowHideLoading(1);

                        var _controlDupplicate = $('#controlDupplicate').val();
                        if (_controlDupplicate == 0) {
                            $('#controlDupplicate').val(1);

                            CheckRV_RSSave = 1;
                            SaveResaleTable(false);
                        }


                    }
                else{
                    CheckRV_RSSave = 0;
                    };
            });


            };
        });

        $('#btn_RSPrint').click(function () {
            if (CheckRV_RSSave == 0) {

            swal({
                title: "Are you sure?",
                text: "Would you like to Save this record?",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "Yes, Cancel it!",
                cancelButtonText: "Close",
                closeOnConfirm: false

            }, function (isConfirm) {
                if (isConfirm == true) {
                    CheckRV_RSSave = 1;
                    SaveResaleTable(true);
                }
                else {
                    CheckRV_RSSave = 0;
                }
            });

            };
        });

        $('#btn_RSClose').click(function () {
            $('#myModalResale').modal('hide');
        });


        $('#btn_RNSave').click(function () {
            if(CheckRV_RNSave == 0){

                swal({
                    title: "Are you sure?",
                    text: "Would you like to Save this record?",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "Yes, Cancel it!",
                    cancelButtonText: "Close",
                    closeOnConfirm: false

                }, function (isConfirm) {
                    if (isConfirm == true) {

                        ShowHideLoading(1);

                        var _controlDupplicate = $('#controlDupplicate').val();
                        if (_controlDupplicate == 0) {
                            $('#controlDupplicate').val(1);

                            CheckRV_RNSave = 1;
                            SaveRentTable(false, 1, false);
                        }


                    }
                    else
                    {
                        CheckRV_RNSave = 0;
                    }
                });
            };
        });

        $('#btn_RNPrint').click(function () {
            if (CheckRV_RNSave == 0) {


            swal({
                title: "Are you sure?",
                text: "Would you like to Save this record?",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "Yes, Cancel it!",
                cancelButtonText: "Close",
                closeOnConfirm: false

            }, function (isConfirm) {
                if (isConfirm == true) {

                    ShowHideLoading(1);

                    var _controlDupplicate = $('#controlDupplicate').val();
                    if (_controlDupplicate == 0) {
                        $('#controlDupplicate').val(1);

                        CheckRV_RNSave = 1;
                        SaveRentTable(false, 1, true);
                    }


                }
                else {
                    CheckRV_RNSave = 0;
                }
            });


            };

        });


        $('#btn_RNClose').click(function () {
            $('#myModalRent').modal('hide');
        });

        $('#btnCloseForm').click(function () {
            $('#CancelFormModel').modal('hide');
        });

        $('#ddl_ReasonCancel').change(function () {
            var isFound = false;
            for (var i = 0; i < $('.select2_ReasonCancel').select2('data').length; i++) {
                var otherTarget = $('.select2_ReasonCancel').select2('data')[i].text;
                if (otherTarget.indexOf("อื่น ๆ") >= 0) {
                    isFound = true;
                    break;
                }
            }
            if (isFound) {
                $('#txtReasonCancelOther').show();
                $('#dvReasonCancel').show();
            } else {
                $('#txtReasonCancelOther').hide();
                $('#dvReasonCancel').hide();
            }
        });

        function CancelFormValidate() {
            var msg = ""
            if ($("#ddl_ReasonCancel").select2().val() == 0) {
                msg = "กรุณาเลือกสาเหตุ";
            }
            else if ($("#ddl_ReasonCancel").select2('data')[0].text.indexOf("อื่น ๆ") >= 0 && $("#txtReasonCancelOther").val() == "") {
                msg = "กรุณาระบุอื่น ๆ";
            }
            else if ($('#text_RemakCancel').val() == "") {
                msg = "กรุณากรอกหมายเหตุ";
            }
            else if ($("#ddlSaleName").val() == null) {
                msg = "กรุณากรอกผู้รับเรื่อง";
            }



            return msg;

        }

        $('#btnDeleteForm').click(function () {
            var msg = CancelFormValidate();
            if (msg != "") {
                swal({
                    title: "ผิดพลาด",
                    text: msg,
                    icon: "warning",
                    button: "Ok"
                });

            } else {
                swal({
                    title: "Are you sure?",
                    text: "Would you like to Cancel this record?",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "Yes, Cancel it!",
                    closeOnConfirm: true
                }, function () {

                    //$('#CF__DSContactID').val();
                    //$('#CF_UnitID').val();
                    //$('#CF_RentID').val();

                    CancelRV($('#CF_RentID').val(), $('#CF_DepositID').val(), $("#EmployeeID").data("emp-id"));
                });
            }
        });

        $('#DataListView').on("click", ".confirm-trash", function () {
            var EmpID = $("#EmployeeID").data("emp-id");
            var _DepositID = $(this).data("dsid");
            var _DSContactID = $(this).data("cust");
            var _UnitID = $(this).data("uid");
            var _RentID = $(this).data("rvtid");
            //alert('DS' + _DepositID + ': Contract' + _DSContactID + ': Unit' + _UnitID + ': RentID' + _RentID);

            $('#CancelFormModel').modal('show');
            $('#CF_DepositID').val(_DepositID);
            $('#CF__DSContactID').val(_DSContactID);
            $('#CF_UnitID').val(_UnitID);
            $('#CF_RentID').val(_RentID);

            $('#ddl_ReasonCancel').select2().val(0).trigger('change');
            $('#ddlSaleName').select2().val(0).trigger('change');
            $('#text_RemakCancel').val("");
            $('#txtReasonCancelOther').val("");

            //swal({
            //    title: "Are you sure?",
            //    text: "Would you like to Cancel this record?",
            //    type: "warning",
            //    showCancelButton: true,
            //    confirmButtonColor: "#DD6B55",
            //    confirmButtonText: "Yes, Cancel it!",
            //    cancelButtonText: "Close",
            //    closeOnConfirm: false

            //}, function (isConfirm) {

            //    if (isConfirm == true) {


            //        //swal({
            //        //    title: "ยกเลิกใบจอง !",
            //        //    text: "<textarea  rows='3' id='text_RemakCancel' style='width: 100%;height: 100%;'></textarea>",
            //        //    // --------------^-- define html element with id ก
            //        //    html: true,
            //        //    showCancelButton: true,
            //        //    closeOnConfirm: false,
            //        //    showLoaderOnConfirm: true,
            //        //    animation: "slide-from-top",
            //        //    inputPlaceholder: "Write something"
            //        //}, function (inputValue) {

            //        //    //alert($('#text_RemakCancel').val());

            //        //    if (inputValue === false) return false;
            //        //    if ($('#text_RemakCancel').val() == "") {
            //        //        swal.showInputError("กรุณากรอกเหตุผลการยกเลิก !");
            //        //        return false
            //        //    }
            //        //    else {

            //        //        CancelRV($('#text_RemakCancel').val(), _RentID, _DepositID, EmpID);
            //        //                return false;
            //        //            }
            //        //});

            //    }

            //});


            //$('#btnSave').attr("disabled", false);
            //CancelRVTavle(,);
        });


        function CancelRV(_RVID, DepositID, EmpID) {

            //long ReservationsID, long DepositID, long Reviser, bool IsCancel, string Remark_Cancel
            //alert("CancelRV");
            var url = '@Url.Action("CancelReservationsTable", "DMPS_ReservationsRoom")';

            var RentID = "";

            var _ReasonCancelID = "";
            var _ReasonCancelOther = "";
            if ($("#ddl_ReasonCancel").select2().val().length > 0) {
                for (var i = 0; i < $("#ddl_ReasonCancel").select2().val().length; i++) {
                    _ReasonCancelID += $("#ddl_ReasonCancel").select2().val()[i] + ",";
                    if ($("#ddl_ReasonCancel").select2('data')[i].text.indexOf("อื่น ๆ") >= 0) {
                        _ReasonCancelOther += $("#txtReasonCancelOther").val() + ",";
                    } else {
                        _ReasonCancelOther += ",";
                    }

                }
                if (_ReasonCancelID.length > 0) {
                    _ReasonCancelID = _ReasonCancelID.substring(0, _ReasonCancelID.length - 1);
                    _ReasonCancelOther = _ReasonCancelOther.substring(0, _ReasonCancelOther.length - 1);
                }

            }

            var Remark_Cancel = $('#text_RemakCancel').val();

            var _SaleName = $('#ddlSaleName').select2().val();


            $.post(url, {
                Reviser: EmpID,
                ReservationsID: _RVID,
                IsCancel: true,
                Remark_Cancel: Remark_Cancel,
                RentID: RentID,
                _ReasonCancelID: _ReasonCancelID,
                _ReasonCancelOther: _ReasonCancelOther,
                DepositID: DepositID,
                _SaleName: _SaleName,


            }, function (result) {
                $('#CancelFormModel').modal('hide');
                if (result != "") {
                    LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), result, null, null);
                    swal("Cancel Complete!!!", "", "success");
                }
                else {
                    //$('#btnRV_Save').attr("disabled", false);
                    //swal("Warnning !", _, "warning");
                    swal("Cancel is not Complete!!!", "", "warning");
                }

            });

            //swal("Cancel Complete!!!", "", "success");
        }


        $('#txt_RNContractPeriod').focusout(function () {

            var _addMonth = $("#txt_RNContractPeriod").val();

            ///alert(_addMonth);

            //var Sdate = new Date(ConvertString2DatetimeFormat($('#txtContractSdate').val()));
            var Sdate = new Date(ConvertString2DatetimeFormat($('#txt_RNContractSdate').val()));
            //alert(Sdate);

            var _DateEnd = new Date(new Date(Sdate).setMonth(Sdate.getMonth() + parseInt(_addMonth)));
            _DateEnd = _DateEnd.setDate(_DateEnd.getDate() - 1);

            $('#txt_RNContractEdate').val(dateFormat(_DateEnd, "dd/mm/yyyy"))


        });

        $('#txt_RNContractSdate').change(function () {


            // Run at Sever
            //var aa = dateFormat(new Date(ConvertString2DatetimeFormat($('#txtContractSdate').val())), "yyyymmdd");

            // Run at My Computer
            var _addMonth = $("#txt_RNContractSdate").val();
            //var Sdate = new Date(ConvertString2DatetimeFormat($('#txtContractSdate').val()));
            var Sdate = new Date(ConvertString2DatetimeFormat($('#txt_RNContractSdate').val()));
            var _DateEnd = new Date(new Date(Sdate).setMonth(Sdate.getMonth() + parseInt(_addMonth)));
            _DateEnd = _DateEnd.setDate(_DateEnd.getDate() - 1);

            $('#txt_RNContractEdate').val(dateFormat(_DateEnd, "dd/mm/yyyy"))
            //alert(dateFormat(_DateEnd), "yyyy-mm-dd");



        });


        $('#txtRVRentPeriod').focusout(function () {



            var _addMonth = $("#txtRVRentPeriod").val();

            ///alert(_addMonth);

            //var Sdate = new Date(ConvertString2DatetimeFormat($('#txtContractSdate').val()));
            var Sdate = new Date(ConvertString2DatetimeFormat($('#dllContractSdate').val()));
            //alert(Sdate);

            var _DateEnd = new Date(new Date(Sdate).setMonth(Sdate.getMonth() + parseInt(_addMonth)));
            _DateEnd = _DateEnd.setDate(_DateEnd.getDate() - 1);

            $('#dllContractEdate').val(dateFormat(_DateEnd, "dd/mm/yyyy"))


        });

        $('#dllContractSdate').change(function () {


            // Run at Sever
            //var aa = dateFormat(new Date(ConvertString2DatetimeFormat($('#txtContractSdate').val())), "yyyymmdd");

            // Run at My Computer
            var _addMonth = $("#txtRVRentPeriod").val();
            //var Sdate = new Date(ConvertString2DatetimeFormat($('#txtContractSdate').val()));
            var Sdate = new Date(ConvertString2DatetimeFormat($('#dllContractSdate').val()));
            var _DateEnd = new Date(new Date(Sdate).setMonth(Sdate.getMonth() + parseInt(_addMonth)));
            _DateEnd = _DateEnd.setDate(_DateEnd.getDate() - 1);

            $('#dllContractEdate').val(dateFormat(_DateEnd, "dd/mm/yyyy"))
            //alert(dateFormat(_DateEnd), "yyyy-mm-dd");



        });

        //$('#DataListView').on("click", ".confirm-Print", function () {
        //    var id = $(this).data("id");
        //    var no = $(this).data("no");
        //    //OutReport(id);
        //});

        LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), 0, null, null);

        $('#btnSearch').click(function () {

            var _strDate = ConvertString2DatetimeFormat($('#StartDate').val());
            var _endDate = ConvertString2DatetimeFormat($('#EndDate').val());
            LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), 0, _strDate, _endDate);
        });


        $("#chkDate").change(function () {
            if ($(this).is(':checked') != true) { //false
                if ($("#ddlUnitStatus").val() == "Please Select") {

                } else if ($("#ddlUnitType").val() == 0) {

                } else if ($("#ddlUnitStatus").val() == "Please Select" && $("#ddlUnitType").val() != 0) {

                } else {
                    LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), 0, null, null);

                }
            } else {
                LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), 0, _strDate, _endDate);
            }

        });

        $("#ddlUnitStatus").change(function () {
            if ($(this).val()) {
                if ($("#chkDate").is(':checked')) {
                    var _strDate = ConvertString2DatetimeFormat($('#StartDate').val());
                    var _endDate = ConvertString2DatetimeFormat($('#EndDate').val());
                    LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), 0, _strDate, _endDate);
                } else {
                    LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), 0, null, null);
                }
            } else {
                LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), 0, null, null);

            }
        });

        $("#ddlUnitType").change(function () {
            if ($(this).val()) {
                if ($("#chkDate").is(':checked')) {
                    var _strDate = ConvertString2DatetimeFormat($('#StartDate').val());
                    var _endDate = ConvertString2DatetimeFormat($('#EndDate').val());
                    LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), 0, _strDate, _endDate);
                } else {
                    LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), 0, null, null);
                }
            } else {
                LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), 0, null, null);

            }
        });


        $('#btnRV_Save').click(function () {

            var _Validate = ValidateData();

            if (_Validate == "") {
                if (CheckSave == 0) {
                    swal({
                        title: "Are you sure?",
                        text: "Would you like to save this record?",
                        type: "warning",
                        showCancelButton: true,
                        confirmButtonColor: "#DD6B55",
                        confirmButtonText: "Yes, Save it!",
                        cancelButtonText: "Cancel",
                        closeOnConfirm: false

                    }, function (isConfirm) {

                        if (isConfirm == true) {

                            //SaveRVTable(_IsPrint, _IsDelete, _IsCancel,IsContact)

                            ShowHideLoading(1);

                            var _controlDupplicate = $('#controlDupplicate').val();
                            if (_controlDupplicate == 0) {
                                $('#controlDupplicate').val(1);

                                SaveRVTable(0, false, false, false);
                            }

                            CheckSave = 1;
                        }

                        if (isConfirm == false) {
                            CheckSave = 0;
                            $('#btnRV_Save').attr("disabled", false);
                        }
                    });
                }

                else {
                    CheckSave = 0;
                    $('#btnRV_Save').attr("disabled", false);
                    swal("Warnning !", _Validate, "warning");
                }

            } else {
                swal("Warnning !", _Validate, "warning");
            }

        });


        $('#btnRV_Print').click(function () {

                var _Validate = ValidateData()

                if (_Validate == "") {

                    if (CheckSave == 0) {
                    swal({
                        title: "Are you sure?",
                        text: "Would you like to save this record?",
                        type: "warning",
                        showCancelButton: true,
                        confirmButtonColor: "#DD6B55",
                        confirmButtonText: "Yes, Save it!",
                        cancelButtonText: "Cancel",
                        closeOnConfirm: false

                    }, function (isConfirm) {


                        if (isConfirm == true) {
                            CheckSave = 1;
                            //SaveRVTable(_IsPrint, _IsDelete, _IsCancel,IsContact)

                            ShowHideLoading(1);

                            var _controlDupplicate = $('#controlDupplicate').val();
                            if (_controlDupplicate == 0) {
                                $('#controlDupplicate').val(1);

                                SaveRVTable(1, false, false, false);
                            }

                        }

                        if (isConfirm == false) {
                            CheckSave = 0;
                            $('#btnRV_Save').attr("disabled", false);
                        }
                    });
                }
                else {
                    CheckSave = 0;
                    $('#btnRV_Save').attr("disabled", false);
                    swal("Warnning !", _Validate, "warning");
                }
            };

        });

        //id ChkAllBefore
        //id ChkAllAfter

        //name CheckAfter
        //name CheckBefore
        $('.chkRVRent').on('ifChecked ifUnchecked', function () {


            if ($('#chkRVRent').is(':checked') == true) {
                $("#chkRVReSale").iCheck('uncheck');
                $("#pRevRent").show();
                $("#pRevResale").hide();
            }
            if ($('#chkRVRent').is(':checked') == false) {
                $("#chkRVReSale").iCheck('check');
                $("#pRevRent").hide();
                $("#pRevResale").show();
            }


            //$("chkRVReSale").iCheck('uncheck');
            //$("pRevRent").show();
            //$("pRevResale").hidden();
        })

        $('.chkRVReSale').on('ifChecked ifUnchecked', function () {
            if ($('#chkRVReSale').is(':checked') == true) {
                $("#chkRVRent").iCheck('uncheck');
                $("#pRevRent").hide();
                $("#pRevResale").show();
            }
            if ($('#chkRVReSale').is(':checked') == false) {
                $("#chkRVRent").iCheck('check');
                $("#pRevRent").show();
                $("#pRevResale").hide();
            }
        })


        //$('#chkRVRent').on('ifUnchecked', function () {
        //    $('#chkRVReSale').iCheck('check');
        //    $("pRevRent").hidden();
        //    $("pRevResale").show();
        //})


        //$('#chkRVReSale').on('ifChecked', function () {
        //    $("chkRVRent").iCheck('uncheck');
        //    $("pRevRent").hidden();
        //    $("pRevResale").show();
        //})


        //$('#chkRVReSale').on('ifUnchecked', function () {
        //    $('#chkRVRent').iCheck('check');
        //    $("pRevRent").show();
        //    $("pRevResale").hidden();
        //})

       /* $("#chkRRShop").change(function () {
            if ($(this).is(':checked')) {
                LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), 0, null, null);
            } else {
                LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), 0, null, null);

            }
        });*/



        $("#ddlDS_UnitType").change(function () {
            if ($("#ddlDS_UnitType").val() == 8 ) {
                $("#accordionShopDetails").show();
            } else {
                $("#accordionShopDetails").hide();
            }
        });


        $("#ddl_RNDS_UnitType").change(function () {
            if ($("#ddl_RNDS_UnitType").val() == 8) {
                $("#showaccordionShopDetails").show();
            } else {
                $("#showaccordionShopDetails").hide();
            }
        });


        $('#btnSave').click(function () {

            $('#btnSave').attr("disabled", true);

            CompareContactDate("")
        });


        $('#btnRV_Close').click(function () {
            $('#myModal').modal('hide');
        });

        $('#btnRv_Cancel').click(function () {
            swal({
                title: "Are you sure?",
                text: "Would you like to save this record?",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "Yes, Save it!",
                closeOnConfirm: false
            }, function () {
                //SaveRVTable(_IsPrint, _IsDelete, _IsCancel,IsContact)
                SaveRVTable(0, true, false, false)
            });
        });

        $('#txtRentPrice').keyup(function (event) {
            // skip for arrow keys
            if (event.which >= 37 && event.which <= 40) {
                event.preventDefault();
            }

            var currentVal = $(this).val();
            var testDecimal = testDecimals(currentVal);
            if (testDecimal.length > 1) {
                console.log("You cannot enter more than one decimal point");
                currentVal = currentVal.slice(0, -1);
            }
            $(this).val(replaceCommas(currentVal));
        });



        $('#txtContractSdate').change(function () {


            // Run at Sever
            //var aa = dateFormat(new Date(ConvertString2DatetimeFormat($('#txtContractSdate').val())), "yyyymmdd");

            // Run at My Computer
            var _addMonth = $("#txtContractPeriod").val();
            //var Sdate = new Date(ConvertString2DatetimeFormatInDate($('#txtContractSdate').val()));
            var Sdate = new Date(ConvertString2DatetimeFormat($('#txtContractSdate').val()));
            var _DateEnd = new Date(new Date(Sdate).setMonth(Sdate.getMonth() + parseInt(_addMonth)));
            _DateEnd = _DateEnd.setDate(_DateEnd.getDate() - 1);

            $('#txtContractEdate').val(dateFormat(_DateEnd, "dd/mm/yyyy"))
            //alert(dateFormat(_DateEnd), "yyyy-mm-dd");



        });



        function formatNumber(num) {
            return num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,")
        }



        function testDecimals(currentVal) {
            var count;
            currentVal.match(/\./g) === null ? count = 0 : count = currentVal.match(/\./g);
            return count;
        }

        function replaceCommas(yourNumber) {
            var components = yourNumber.toString().split(".");
            if (components.length === 1)
                components[0] = yourNumber;
            components[0] = components[0].replace(/\D/g, "").replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            if (components.length === 2)
                components[1] = components[1].replace(/\D/g, "");
            return components.join(".");
        }


        $('#txtCus_IDCard').keyup(function () {
            var _IDCard = $(this).val();

            var _CustomerTypeId;
            if ($('#chkRVRent').is(':checked') == true) { _CustomerTypeId = 2 } else { _CustomerTypeId = 3;};

            var url = '@Url.Action("getSellerDetail", "DMPS_ReservationsRoom")';
            $.post(url, { IDCard: _IDCard, CustomerTypeId: _CustomerTypeId }, function (result) {
                var obj = $.parseJSON(result);
                if (obj.CitizenID != null) {
                    /////ข้อมูลผู้เช่า (รายละเอียดตามบัตรประชาชน)
                    $('#txtRSCustID').val(obj.ContactsID);
                    $('#txtCus_Name').val(obj.NameFullPre);
                    $('#txtCus_IDCard').val(obj.CitizenID);
                    $('#txtCus_Age').val(obj.Age);
                    $('#ddlCus_CardDate').val(ConvertJson2DatetimeFormat2(obj.CitizenIssue, "dd/mm/yyyy"));
                    $('#ddlCus_CardExpire').val(ConvertJson2DatetimeFormat2(obj.CitizenExp, "dd/mm/yyyy"));
                    $('#txtCus_Nationality').val(obj.Nationality);
                    $('#ddlCardFrom').select2("val", obj.CitizenProvince);

                    $('#txtCus_Address').val(obj.AddressNo);
                    $('#txtCus_Moo').val(obj.Moo);
                    $('#txtCus_Soi').val(obj.Soi);
                    $('#txtCus_Road').val(obj.Road);

                    if (obj.Province != 0) {
                        $('#ddlProvince').select2("val", obj.Province);
                        setTimeout(function () { $('#ddlDistrict').select2("val", obj.District); }, 500);
                        setTimeout(function () { $('#ddlSubDistrict').select2("val", obj.SubDistrict); }, 1000);
                    }
                    else {
                        $('#ddlProvince').select2("val", "");
                        $('#ddlDistrict').select2("val", "");
                        $('#ddlSubDistrict').select2("val", "");
                    }

                    $('#txtCus_Zipcode').val(obj.ZipCode);
                    $('#txtCus_Tel').val(obj.Tel1);
                    $('#txtCus_Company').val(obj.AddressNo_Work);
                    $('#txtTelCellPhone').val(obj.Tel2);
                    $('#txtEmail').val(obj.Email);
                }


            })
        });

        function LoadDataListView(IsAdmin, EmpCode, RentID, _Sdate, _Edate) {
            ShowHideLoading(1);
            var EmpID = $("#EmployeeID").data("emp-id");
            var ParentDeptID = $("#EmployeeID").data("parent-dept");

            //var StartDate = ConvertString2DatetimeFormat($('#StartDate').val());
            //var EndDate = ConvertString2DatetimeFormat($('#EndDate').val());
            var url = '@Url.Action("LoadDataListView", "DMPS_ReservationsRoom")';
            //var _isChkRR = false;
            //if ($("#chkRRShop").is(":checked")) {
            //    _isChkRR = true;

            var _chkDate = false;
            if ($("#chkDate").is(":checked")) {
                _chkDate = true;
            }

            var _ddlUnitType = $("#ddlUnitType").val();
            var _ddlUnitStatus = $("#ddlUnitStatus").find("option:selected").text();

            $('#DataListView').load(url,
            {
                IsAdmin: IsAdmin,
                EmpCode: EmpCode,
                ReservationsID: RentID,
                SDate: _Sdate,
                EDate: _Edate,
               // _isChkRR: _isChkRR,
                _chkDate: _chkDate,
                _ddlUnitType: _ddlUnitType,
                _ddlUnitStatus: _ddlUnitStatus
            }, function (result) {
                $('.dataTables-example').DataTable({
                    "order": [0, "asc"],
                    "scrollX": true,
                    "sScrollX": "3500px",
                    "autoWidth": true,
                    dom: '<"html5buttons"B>lTfgitp',
                    buttons: [
                        { extend: 'excel', title: 'ExcelFile' },
                    ]
                });

                ShowHideLoading(0);
            });
        }


        function LoadDepartment(comID, DeptId) {
            var url = '@Url.Action("getDepartment", "EMSG_DocumentStatus")';
            $("#ddlDepartment").select2({ data: null });
            $.post(url, { CompanyID: comID }, function (result) {
                var foo = $.parseJSON(result);
                $("#ddlDepartment").select2({ data: foo });
                $("#ddlDepartment").select2("val", DeptId);
            });
        }

        function LoadEmployeelst(_SysAdmin, _Depts, EmpID) {
            var url = '@Url.Action("LoadEMP", "DMPS_DepositRoom")';
            $("#ddlInChargeBy").select2({ data: null });
            $("#ddlInChargeBy").empty();
            $.post(url, { SysAdmin: _SysAdmin, Depts: _Depts, EmpCode: EmpID }, function (result) {

                var foo = $.parseJSON(result);
                //console.log(foo);
                $("#ddlInChargeBy").select2({ data: foo });
                $("#ddlInChargeBy").select2("val", EmpID);
            });
        };

        function LoadEmployee(comID, EmpID) {
            var url = '@Url.Action("getEmployee", "EMSG_DocumentStatus")';
            $("#ddlWorkOwner").select2({ data: null });
            $.post(url, { CompanyID: comID }, function (result) {
                var foo = $.parseJSON(result);
                $("#ddlInChargeBy").select2({ data: foo });
                $("#ddlInChargeBy").select2("val", EmpID);
            });
        }

        function LoadPosition(empID) {
            var url = '@Url.Action("getDetailEmployee", "EMSG_DocumentStatus")';
            $.post(url, { EmployeeID: empID }, function (result) {
                var sp = result.split("|");
                $('#ddlPosition').val(sp[1]).change();
            });
        }

        $('#ddlInChargeBy').change(function () {
            var empID = $('#ddlInChargeBy').val();
            var url = '@Url.Action("getDetailEmployee", "EMSG_DocumentStatus")';
            $.post(url, { EmployeeID: empID }, function (result) {
                var sp = result.split("|");

                var comID = $('#ddlCompany').val();

                $('#ddlPosition').select2("val", sp[1]);
                $('#ddlDepartment').select2("val", sp[0]);
                $('#ddlCompany').select2("val", sp[2]);
            });
        });



        function populateDropdown(select, data) {
            select.html('');
            select.append($('<option></option>').val(0).html('Please Select'));
            $.each(data, function (id, option) {
                select.append($('<option></option>').val(option.value).html(option.name));
            });
        }



        function SetDistinct(_ProviceID) {
            if (_ProviceID != 0 && _ProviceID != "") {
                var url = '@Url.Action("getDistinct", "DMPS_DepositRoom")';
                $('#ddlDistrict').empty();
                $("#ddlDistrict").select2({ data: null });

                $.post(url,
                    {
                        ProviceID: _ProviceID
                    }, function (result) {

                        var foo = $.parseJSON(result);
                        $("#ddlDistrict").select2({ data: foo });
                        $("#ddlDistrict").select2("val", 0);

                        $('#ddlDistrict').attr("disabled", false);
                        $('#ddlSubDistrict').attr("disabled", true);
                    });
            }
            else {
                $("#ddlDistrict").select2("val", 0);
                $('#ddlDistrict').attr("disabled", true);
                $("#ddlSubDistrict").select2("val", 0);
                $('#ddlSubDistrict').attr("disabled", true);
            };


        }

        function SetSubDistinct(_ProviceID, _DistinctID) {
            if (_ProviceID != null && _ProviceID != 0 && _ProviceID != "" && _DistinctID != null && _DistinctID != 0 && _DistinctID != "") {

                var url = '@Url.Action("getSubDistinct", "DMPS_DepositRoom")';
                $('#ddlSubDistrict').empty();
                $("#ddlSubDistrict").select2({ data: null });

                $.post(url,
                    {
                        ProviceID: _ProviceID,
                        DistinctID: _DistinctID
                    }, function (result) {

                        var foo = $.parseJSON(result);
                        $("#ddlSubDistrict").select2({ data: null });
                        $("#ddlSubDistrict").select2({ data: foo });
                        $("#ddlSubDistrict").select2("val", 0);

                        $('#ddlSubDistrict').attr("disabled", false);
                    });
            }
            else {
                $("#ddlSubDistrict").select2("val", 0);
                $('#ddlSubDistrict').attr("disabled", true);
            };


        }

           //set ZipCode by string of subdistrict district and Province
        $("#ddlSubDistrict").change(function () {

            var _Province = $("#ddlProvince").find("option:selected").text();
            var _Distinct = $("#ddlDistrict").find("option:selected").text();
            var _SubDistinct = $("#ddlSubDistrict").find("option:selected").text();
            if ((_Province != "" && _Province != "Please Select")
                && (_Distinct != "" && _Distinct != "Please Select")
                && (_SubDistinct != "" && _SubDistinct != "Please Select")) {
                SetZipCode(_Province, _Distinct, _SubDistinct);

            }
        });

        $("#ddlSubDistrict").change(function () {
            $("#txt_RNCus_Zipcode").val("");
            $("#txtCus_Zipcode").val("");
            $("#txt_RSCus_Zipcode").val("");

            document.getElementById("txt_RNCus_Zipcode").disabled = false;
            document.getElementById("txtCus_Zipcode").disabled = false;
            document.getElementById("txt_RSCus_Zipcode").disabled = false;

        });

        function SetZipCode(_Province, _Distinct, _SubDistinct) {
            var url = '@Url.Action("SetZipcode", "DMPS_DepositRoom")';

            $.post(url, {
                _Province: _Province.trim(),
                _Distinct: _Distinct.trim(),
                _SubDistinct: _SubDistinct.trim(),

            }, function (result) {
                var _result = $.parseJSON(result);
                $("#txt_RNCus_Zipcode").val(_result[0]);
                $("#txtCus_Zipcode").val(_result[0]);
                $("#txt_RSCus_Zipcode").val(_result[0]);
                if ($("#txt_RNCus_Zipcode").val() != "") { document.getElementById("txt_RNCus_Zipcode").disabled = true; }
                if ($("#txtCus_Zipcode").val() != "") { document.getElementById("txtCus_Zipcode").disabled = true; }
                if ($("#txt_RSCus_Zipcode").val() != "") { document.getElementById("txt_RSCus_Zipcode").disabled = true; }

            });

        }

        function SetddlProject(_ID, _DevID) {

            var url = '@Url.Action("getProject", "DMPS_DepositRoom")';
            $("#ddlDS_Project").empty();
            $("#ddlDS_Project").select2({ data: null });

            $.post(url,
                {
                    DeveloperID: _DevID
                }, function (result) {

                    var foo = $.parseJSON(result);
                    $("#ddlDS_Project").select2({ data: foo });
                    $("#ddlDS_Project").select2("val", _ID);

                    $('#dvddlDS_Project').show();
                    $('#dvtxtDS_Project').hide();

                    $('#btnAddProject').show();

                    $('#btnSaveProject').hide();
                    $('#btnClearProject').hide();

                });

        }

        function SetddlDeveloper(_ID) {

            var url = '@Url.Action("getDevelopment", "DMPS_DepositRoom")';

            $("#ddlDS_Developer").select2({ data: null });

            $.post(url, function (result) {

                var foo = $.parseJSON(result);
                $("#ddlDS_Developer").select2({ data: foo });
                $("#ddlDS_Developer").select2("val", _ID);

                $('#dvddlDS_Developer').show();
                $('#dvtxtAddDeveloper').hide();

                $('#btnAddDeveloper').show();

                $('#btnSaveDeveloper').hide();
                $('#btnClearDeveloper').hide();


            });

        }

        $("#ddlProvince").change(function () {
            var _ProvinceID = $("#ddlProvince").val();
            SetDistinct(_ProvinceID);
        });

        $("#ddl_RNProvince").change(function () {
            var _ProvinceID = $("#ddl_RNProvince").val();
            SetDistinctRN(_ProvinceID);
        });

        $("#ddl_RSProvince").change(function () {
            var _ProvinceID = $("#ddl_RSProvince").val();
            SetDistinctRS(_ProvinceID);
        });



        $("#ddlDistrict").change(function () {
            var _ProvinceID = $("#ddlProvince").val();
            var _DistinctID = $("#ddlDistrict").val();
            SetSubDistinct(_ProvinceID, _DistinctID);
        });

        $("#ddl_RNDistrict").change(function () {
            var _ProvinceID = $("#ddl_RNProvince").val();
            var _DistinctID = $("#ddl_RNDistrict").val();

            SetSubDistinctRN(_ProvinceID, _DistinctID);
        });

        $("#ddl_RSDistrict").change(function () {
            var _ProvinceID = $("#ddl_RSProvince").val();
            var _DistinctID = $("#ddl_RSDistrict").val();

            SetSubDistinctRS(_ProvinceID, _DistinctID);
        });


        function SetDistinctRN(_ProviceID) {
            //console.log("xxx", "SetDistinctRN", _ProviceID)
            if (_ProviceID != null || _ProviceID != 0) {

                var url = '@Url.Action("getDistinct", "DMPS_DepositRoom")';

                //$('#ddlDistrict').val(null).trigger('change');
                //$("#ddlDistrict > option").removeAttr("selected");
                //$("#ddlDistrict").trigger("change");

                //$('#ddlDistrict').select2({
                //    //placeholder: "Select groups...",
                //    allowClear: true,
                //    width: '100%',
                //})
                $('#ddl_RNDistrict').empty();
                $("#ddl_RNDistrict").select2({ data: null });

                $.post(url,
                    {
                        ProviceID: _ProviceID
                    }, function (result) {

                        var foo = $.parseJSON(result);
                        $("#ddl_RNDistrict").select2({ data: foo });
                        $("#ddl_RNDistrict").select2("val", 0); // ""

                        $('#ddl_RNDistrict').attr("disabled", true); //.
                        $('#ddl_RNSubDistrict').attr("disabled", true); //.t
                    });
            }
            else {
                $("#ddl_RNDistrict").select2("val", 0);
                $('#ddl_RNDistrict').attr("disabled", true); //.
                $("#ddl_RNSubDistrict").select2("val", 0);
                $('#ddl_RNSubDistrict').attr("disabled", true);//.
            };
        }


        function SetDistinctRS(_ProviceID) {
            //console.log("xxx", "SetDistinctRS", _ProviceID)
            if (_ProviceID != null || _ProviceID != 0) {

                var url = '@Url.Action("getDistinct", "DMPS_DepositRoom")';

                //$('#ddlDistrict').val(null).trigger('change');
                //$("#ddlDistrict > option").removeAttr("selected");
                //$("#ddlDistrict").trigger("change");

                //$('#ddlDistrict').select2({
                //    //placeholder: "Select groups...",
                //    allowClear: true,
                //    width: '100%',
                //})
                $("#ddl_RSDistrict").empty();
                $("#ddl_RSDistrict").select2({ data: null });

                $.post(url,
                    {
                        ProviceID: _ProviceID
                    }, function (result) {

                        var foo = $.parseJSON(result);
                        $("#ddl_RSDistrict").select2({ data: foo });
                        $("#ddl_RSDistrict").select2("val", 0); // ""

                        $('#ddl_RSDistrict').attr("disabled", false);
                        $('#ddl_RSSubDistrict').attr("disabled", true); //.t
                    });
            }
            else {
                $("#ddl_RSDistrict").select2("val", 0);
                $('#ddl_RSDistrict').attr("disabled", true); //.f
                $("#ddl_RSSubDistrict").select2("val", 0);
                $('#ddl_RSSubDistrict').attr("disabled", true); //.f
            };
        }


        function SetDistinct(_ProviceID) {
            if (_ProviceID != null && _ProviceID != 0 && _ProviceID != "") {
                var url = '@Url.Action("getDistinct", "DMPS_DepositRoom")';


                $('#ddlDistrict').empty();
                $("#ddlDistrict").select2({ data: null });

                $.post(url,
                    {
                        ProviceID: _ProviceID
                    }, function (result) {

                        var foo = $.parseJSON(result);
                        $("#ddlDistrict").select2({ data: foo });
                        $("#ddlDistrict").select2("val", 0); // ""

                        $("#ddlDistrict").attr("disabled", false);  //.
                        $('#ddlSubDistrict').attr("disabled", true); //.f

                    });
            }
            else {
                $("#ddlDistrict").select2("val", 0);
                $('#ddlDistrict').attr("disabled", true); //.f
                $("#ddlSubDistrict").select2("val", 0);
                $('#ddlSubDistrict').attr("disabled", true); //.f
            };
        }


        function SetSubDistinctRN(_ProviceID, _DistinctID) {

            if (_ProviceID != null && _ProviceID != 0 && _ProviceID != "" && _DistinctID != null && _DistinctID != 0 && _DistinctID != "") {

                var url = '@Url.Action("getSubDistinct", "DMPS_DepositRoom")';

                //$("#ddlSubDistrict").select2({ data: null });
                $('#ddl_RNSubDistrict').empty();
                $("#ddl_RNSubDistrict").select2({ data: null });

                $.post(url,
                    {
                        ProviceID: _ProviceID,
                        DistinctID: _DistinctID
                    }, function (result) {

                        var foo = $.parseJSON(result);

                        $("#ddl_RNSubDistrict").select2({ data: foo });
                        $("#ddl_RNSubDistrict").select2("val", 0); // ""

                        $('#ddl_RNSubDistrict').attr("disabled", true); //.
                    });
            }
            else {
                $("#ddl_RNSubDistrict").select2("val", 0);
                $('#ddl_RNSubDistrict').attr("disabled", true);//.
            };


        }

        function SetSubDistinctRS(_ProviceID, _DistinctID) {

            if (_ProviceID != null && _ProviceID != 0 && _ProviceID != "" && _DistinctID != null && _DistinctID != 0 && _DistinctID != "") {

                var url = '@Url.Action("getSubDistinct", "DMPS_DepositRoom")';

                $("#ddlSubDistrict").select2({ data: null }); //.
                $('#ddl_RSSubDistrict').empty();
                $("#ddl_RSSubDistrict").select2({ data: null });

                $.post(url,
                    {
                        ProviceID: _ProviceID,
                        DistinctID: _DistinctID
                    }, function (result) {

                        var foo = $.parseJSON(result);

                        $("#ddl_RSSubDistrict").select2({ data: foo });
                        $("#ddl_RSSubDistrict").select2("val", 0); // ""

                        $('#ddl_RSSubDistrict').attr("disabled", false); //.
                    });
            }
            else {
                $("#ddl_RSSubDistrict").select2("val", 0);
                $('#ddl_RSSubDistrict').attr("disabled", true); //.
            };


        }


        function SetSubDistinct(_ProviceID, _DistinctID) {

            if (_ProviceID != null && _ProviceID != 0 && _ProviceID != "" && _DistinctID != null && _DistinctID != 0 && _DistinctID != "") {

                var url = '@Url.Action("getSubDistinct", "DMPS_DepositRoom")';

               //$("#ddlSubDistrict").select2({ data: null });
                $('#ddlSubDistrict').empty();
                $("#ddlSubDistrict").select2({ data: null });

                $.post(url,
                    {
                        ProviceID: _ProviceID,
                        DistinctID: _DistinctID
                    }, function (result) {

                        var foo = $.parseJSON(result);

                        $("#ddlSubDistrict").select2({ data: foo });
                        $("#ddlSubDistrict").select2("val", 0); // ""

                        $('#ddlSubDistrict').attr("disabled", false); //.
                    });
            }
            else {
                $("#ddlSubDistrict").select2("val", 0);
                $('#ddlSubDistrict').attr("disabled", true); //.
            };


        }


        function SaveRentTable(_IsDelete, _UnitStatus, _Type) {
            var EmpID = $("#EmployeeID").data("emp-id");

            var _DSCustID = $('#txt_RNDSCustID').val();
            var _DepositID = $('#txt_RNDepositID').val();
            var _UnitID = $('#txt_RNUnitID').val();
            var _RTCustID = $('#txt_RNRTCustID').val();
            var _RentID = $('#txt_RNRentID').val();

            var _ReservationsID = $('#txt_RNReservationsID').val();
            var _RVCustomerID = $('#txt_RNRVCusID').val();

            var _DocRef = $('#txt_RNDocsRef').val();

            var _RTName = $('#txt_RNCus_Name').val();
            var _RTCardID = $('#txt_RNCus_IDCard').val();
            var _RTAge = $('#txt_RNCus_Age').val();
            var _RTCardIssue = ConvertString2DatetimeFormat($('#ddl_RNCus_CardDate').val());
            var _RTCardExpire = ConvertString2DatetimeFormat($('#ddl_RNCus_CardExpire').val());
            var _RTCardFrom = $('#ddl_RNCardFrom').val();
            var _RTAddressNo = $('#txt_RNCus_Address').val();
            var _RTMoo = $('#txt_RNCus_Moo').val();
            var _RTSoi = $('#txt_RNCus_Soi').val();
            var _RTRoad = $('#txt_RNCus_Road').val();
            var _RTSubDistinct = $('#ddl_RNSubDistrict').val();
            var _RTDistinct = $('#ddl_RNDistrict').val();
            var _RTProvince = $('#ddl_RNProvince').val();
            var _RTZipcode = $('#txt_RNCus_Zipcode').val();
            var _RTTel = $('#txt_RNCus_Tel').val();

            var _TelMobile = $('#txt_RNTelCellPhone').val();
            var _Email = $('#txt_RNEmail').val();

            var _RTNationality = $('#txt_RNCus_Nationality').val();
            var _RTCompanyAddress = $('#txt_RNCus_Company').val();

            var _RentDate = ConvertString2DatetimeFormat($('#ddl_RNDocDate').val());
            var _RentAt = $('#txt_RNDocAt').val();

            var _ContractPeriod = $('#txt_RNContractPeriod').val();

            var _ContractSdate = ConvertString2DatetimeFormat($('#txt_RNContractSdate').val());
            var _ContractEdate = ConvertString2DatetimeFormat($('#txt_RNContractEdate').val());
            var _RentPrice = $('#txt_RNRentPrice').val().replace(/,\s?/g, "");
            var _DayOfDue = $('#txt_RNDayOfDue').val();

            var _RoomInsurance = $('#txt_RNRoomInsurance').val();
            var _RoomInsurancePrice = $('#txt_RNRoomInsurancePrice').val().replace(/,\s?/g, "");

            var _DepositRent = $('#txt_RNDepositRent').val();
            var _DepositRentPrice = $('#txt_RNDepositRentPrice').val().replace(/,\s?/g, "");

            var _DepositMulctPrice = $('#txt_RNDepositMulctPrice').val().replace(/,\s?/g, "");

            //var _RentFurniture = $('#txtRentFurniture').val().replace(/,\s?/g, "");

            var _RentFurnitureQty = $('#txt_RNRentFurnitureQty').val()
            var _RentFurniturePrice = $('#txt_RNRentFurniture').val().replace(/,\s?/g, "");


            var _DepositFurQty = $('#txt_RNDepositFur').val()
            var _DepositFurPrice = $('#txt_RNDepositFurPrice').val().replace(/,\s?/g, "");

            ////////// ประเภทการชำระค่าใช้จ่ายต่างๆ

            var _AmountCash = $('#txtReserve_RNAmountCash').val().replace(/,\s?/g, "");

            var _AmountCashier = $('#txtReserve_RNAmountCashier').val().replace(/,\s?/g, "");
            var _AmounCashTransfer = $('#txtReserve_RNAmounCashTransfer').val().replace(/,\s?/g, "");


            var _CashierBank = $('#ddl_RNCashierBank').val();
            var _CashierNo = $('#txtReserve_RNCashierNo').val();
            var _CashierNoDate = ConvertString2DatetimeFormat($('#dllRNCashierDate').val());

            var _BankNameCashTransfer = $('#txtReserve_RNBankNameCashTransfer').val();
            var _BankNoCashTransfer = $('#txtReserve_RNBankNoCashTransfer').val();
            var _CashTransferDate = ConvertString2DatetimeFormat($('#dllRNCashTransferDate').val());
            /////////////////////


            var _RentRemark = $('#txtCheckRoomRemarkDeposit').val();
            var tableCHKRoom = $('#CheckRoomMasterTB tbody tr');
            var param_items2 = "";


            var _IsUnExpireCard = false;
            if ($('#ChkUnExpireCard').is(':checked') == true) { _IsUnExpireCard = true };

            var _IsForeign = false;
            if ($('#chkRVisForeign').is(':checked') == true) { _IsForeign = true };


            for (i = 0; i < tableCHKRoom.length; i++) {
                if (i != 0) {
                    param_items2 += ",";
                }

                var Qty;
                var BrokenQty;

                if ($(tableCHKRoom[i]).find(".clsCheckQty").val() == null || $(tableCHKRoom[i]).find(".clsCheckQty").val() == "") { Qty = "0"; }
                else { Qty = $(tableCHKRoom[i]).find(".clsCheckQty").val(); }

                if ($(tableCHKRoom[i]).find(".clsBrokenCheckQty").val() == null || $(tableCHKRoom[i]).find(".clsBrokenCheckQty").val() == "") { BrokenQty = "0"; }
                else { BrokenQty = $(tableCHKRoom[i]).find(".clsBrokenCheckQty").val(); }

                param_items2 += '{"CheckRoomID": "' + $(tableCHKRoom[i]).find(".clsCheckRoomID").val() + '", "CheckRoomDesc":"' + $(tableCHKRoom[i]).find(".clsCheckRoomDesc").text() + '","CheckQTY":"' + Qty + '","CheckCheckRoom":"' + $(tableCHKRoom[i]).find(".clsCheckRoomID").is(':checked') + '","CheckBrokenQTY":"' + BrokenQty + '","CheckBrokenRoom":"' + $(tableCHKRoom[i]).find(".clsBrokenCheck").is(':checked') + '"}';
            };


            var url = '@Url.Action("SaveRentTable", "DMPS_ReservationsRoom")';
            $.post(url, {
                ContactsID: _RTCustID,
                CustomerTypeId: 2,
                FirstName: _RTName,
                Age: _RTAge,
                CitizenID: _RTCardID.replace(" ", "").replace("-", "").toLowerCase(),
                CitizenIssue: _RTCardIssue,
                CitizenExp: _RTCardExpire,
                UnExpireIDCard: _IsUnExpireCard,
                CitizenProvince: _RTCardFrom,
                Tel1: _RTTel,
                AddressNo: _RTAddressNo,
                Moo: _RTMoo,
                Soi: _RTSoi,
                Road: _RTRoad,
                SubDistrict: _RTSubDistinct,
                District: _RTDistinct,
                Province: _RTProvince,
                ZipCode: _RTZipcode,
                AddressNo_Work: _RTCompanyAddress,
                Nationality: _RTNationality,
                RentID: _RentID,
                RentDate: _RentDate,
                RentAt: _RentAt,
                RTContractID: _RTCustID,
                RentStatus: _UnitStatus,
                RentPeriod: _ContractPeriod,
                RentStartDate: _ContractSdate,
                RentEndDate: _ContractEdate,
                RentPrice: _RentPrice,
                DayofDue: _DayOfDue,
                RoomInsuranceQty: _RoomInsurance,
                RoomInsuranceAmt: _RoomInsurancePrice,
                RoomDepositQty: _DepositRent,
                RoomDepositAmt: _DepositRentPrice,
                Creator: EmpID,
                Reviser: EmpID,
                IsDelete: _IsDelete,
                DepositID: _DepositID,
                CreateBy: EmpID,
                ModifyBy: EmpID,
                lstCheckRoom: '[' + param_items2 + ']',
                CheckRoomRemarkRent: _RentRemark,
                DocRef: _DocRef,
                Tel2: _TelMobile,
                Email: _Email,
                MulctPrice: _DepositMulctPrice,
                RoomFurnitureAmt: _RentFurniturePrice,
                RoomFurnitureQty: _RentFurnitureQty,
                RoomFurnitureDepositQty: _DepositFurQty,
                RoomFurnitureDepositAmt: _DepositFurPrice,

                Pay_Cash: _AmountCash,
                Pay_Cashier: _AmountCashier,
                Pay_CashierBank: _CashierBank,
                Pay_CashierNo: _CashierNo,
                Pay_CashierDate: _CashierNoDate,
                Pay_TransferCash: _AmounCashTransfer,
                Pay_TransferBankNo: _BankNoCashTransfer,
                Pay_TransferCashDate: _CashTransferDate,
                Pay_TransferBankName: _BankNameCashTransfer,

                ReservationsID: _ReservationsID,
                RVCustomerID: _RVCustomerID,

                CommissionChecked : false,
                CommissionPrice: 0,

                IsForeign: _IsForeign,


            }, function (result) {

                if (result != "") {
                    ShowHideLoading(0);
                    CheckRV_RNSave  = 0;
                    var sp = result.split("|");
                    saveFileUpload(sp[1]);

                    if (_Type == true) {
                        OutReportRN(sp[1]);
                        if (_RentFurniturePrice != 0) { PrintReportFurniture(sp[1]); }

                        var url = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RN_RENT_Temp_Reciept_001" + "&objName=" + "RentID" + "&objValue=" + sp[1];
                        loadNewPage(url);
                    }

                    LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), sp[1], null, null);
                    swal("Save Complete!!!", "", "success");
                    $('#myModalRent').modal('hide');

                }
                else {
                    ShowHideLoading(0);
                    ShowHideLoading(0);
                    CheckRV_RNSave = 0;
                    swal({
                        title: "Save isn't Complete.",
                        text: "Save Error!!!"
                    });
                }


            });


        }

        function OutReport(id) {
            var url = '@Url.Action("PrintReport", "DMPS_ReleaseRoom")' + "?ReportID=" + id;
            window.open(url, '_blank');
        }


        function PrintReportFurniture(id) {
            var url = '@Url.Action("PrintReportFurniture", "DMPS_ReleaseRoom")' + "?ReportID=" + id;
            window.open(url, '_blank');
        }


        function ValidationRS() {
            var _IsValid = true;
            var _Message = "";

            var _SalePrice = $('#txt_RSSalePrice').val();
            var _NetPrice = $('#txt_RSNetPrice').val();
            var _RSCardID = $('#txt_RSCus_IDCard').val();
            var _RSName = $('#txt_RSCus_Name').val();
            var _RSTel = $('#txt_RSCus_Tel').val();

            if (_SalePrice <= 0) {
                _Message = "กรุณากรอกข้อมูลราคาขาย";
                _IsValid = false;
            }
            else if (_NetPrice <= 0) {
                _Message = "กรุณากรอกข้อมูลราคาขายสุทธิ";
                _IsValid = false;
            }
            else if (_RSCardID == "") {
                _Message = "กรุณากรอกข้อมูลเลขที่บัตรประชาชน";
                _IsValid = false;
            }
            else if (_RSName == "") {
                _Message = "กรุณากรอกข้อมูลชื่อ - สกุล";
                _IsValid = false;
            }
            else if (_RSTel == "") {
                _Message = "กรุณากรอกข้อมูลเบอร์โทร";
                _IsValid = false;
            }

            if (!_IsValid) { swal("ผลการตรวจสอบ", _Message, "error"); }
            return _IsValid;
        }

        function SaveResaleTable(_IsPrint) {
            var EmpID = $("#EmployeeID").data("emp-id");
            var _DSCustID = $('#txt_RSDSCustID').val();
            var _DepositID = $('#txt_RSDepositID').val();
            var _UnitID = $('#txt_RSUnitID').val();
            var _RTCustID = $('#txt_RSRTCustID').val();
            //var _RVID = $('#txtRVID').val();
            var _ReservationsID = $('#txt_RSReservationsID').val();
            var _RVCusID = $('#txt_RSRVCusID').val();


            var _ResaleID = 0;

            var _RSName = $('#txt_RSCus_Name').val();
            var _RSCardID = $('#txt_RSCus_IDCard').val();
            var _RSAge = $('#txt_RSCus_Age').val();
            var _RSCardIssue = ConvertString2DatetimeFormat($('#ddl_RSCus_CardDate').val());
            var _RSCardExpire = ConvertString2DatetimeFormat($('#ddl_RSCus_CardExpire').val());
            var _RSCardFrom = $('#ddl_RSCardFrom').val();
            var _RSAddressNo = $('#txt_RSCus_Address').val();
            var _RSMoo = $('#txt_RSCus_Moo').val();
            var _RSSoi = $('#txt_RSCus_Soi').val();
            var _RSRoad = $('#txt_RSCus_Road').val();
            var _RSSubDistinct = $('#ddl_RSSubDistrict').val();
            var _RSDistinct = $('#ddl_RSDistrict').val();
            var _RSProvince = $('#ddl_RSProvince').val();
            var _RSZipcode = $('#txt_RSCus_Zipcode').val();
            var _RSTel = $('#txt_RSCus_Tel').val();
            var _TelMobile = $('#txt_RSTelCellPhone').val();
            var _Email = $('#txt_RSEmail').val();
            var _RSNationality = $('#txt_RSCus_Nationality').val();
            var _RSCompanyAddress = $('#txt_RSCus_Company').val();

            var _ResaleDate = ConvertString2DatetimeFormat($('#ddlRSDocDate').val());
            var _ResaleAt = $('#txtRSDocAt').val();

            var _SalePrice = $('#txt_RSSalePrice').val().replace(/\,/g, '');
            var _SaleDiscount = $('#txt_RSSaleDiscount').val().replace(/\,/g, '');
            var _TranferDiscount = $('#txt_RSTranferDiscount').val().replace(/\,/g, '');
            var _NetPrice = $('#txt_RSNetPrice').val().replace(/\,/g, '');
            var _PricePerSQM = $('#txt_RSPricePerSQM').val().replace(/\,/g, '');
            var _PriceBeforeVat = $('#txt_RSPriceBeforeVat').val().replace(/\,/g, '');
            var _Vat = $('#txt_RSVat').val().replace(/\,/g, '');
            var _PriceIncVat = $('#txt_RSPriceIncVat').val().replace(/\,/g, '');
            var _TransferFeeAmt = $('#txtTransferFeeAmt').val().replace(/\,/g, '');

            var _ContactAmt = $('#txtContactAmt').val().replace(/\,/g, '');

            ////////// ประเภทการชำระค่าใช้จ่ายต่างๆ

            var _AmountCash = $('#txtReserve_RSAmountCash').val().replace(/,\s?/g, "");

            var _AmountCashier = $('#txtReserve_RSAmountCashier').val().replace(/,\s?/g, "");
            var _AmounCashTransfer = $('#txtReserve_RSAmounCashTransfer').val().replace(/,\s?/g, "");


            var _CashierBank = $('#ddl_RSCashierBank').val();
            var _CashierNo = $('#txtReserve_RSCashierNo').val();
            var _CashierNoDate = ConvertString2DatetimeFormat($('#dllRSCashierDate').val());

            var _BankNameCashTransfer = $('#txtReserve_RSBankNameCashTransfer').val();
            var _BankNoCashTransfer = $('#txtReserve_RSBankNoCashTransfer').val();
            var _CashTransferDate = ConvertString2DatetimeFormat($('#dllRSCashTransferDate').val());
            /////////////////////


            var _DocRef = $('#txtRSDocsRef').val();


            var _IsUnExpireCard = false;
            if ($('#Chk_RSUnExpireCard').is(':checked') == true) { _IsUnExpireCard = true };


            if (!ValidationRS()) { return; }

            var url = '@Url.Action("SaveResaleTable", "DMPS_ReservationsRoom")';
            $.post(url, {
                ContactsID: _RVCusID,
                CustomerTypeId: 3,
                FirstName: _RSName,
                Age: _RSAge,
                CitizenID: _RSCardID,
                CitizenIssue: _RSCardIssue,
                CitizenExp: _RSCardExpire,
                UnExpireIDCard: _IsUnExpireCard,
                CitizenProvince: _RSCardFrom,
                Tel1: _RSTel,
                AddressNo: _RSAddressNo,
                Moo: _RSMoo,
                Soi: _RSSoi,
                Road: _RSRoad,
                SubDistrict: _RSSubDistinct,
                District: _RSDistinct,
                Province: _RSProvince,
                ZipCode: _RSZipcode,
                AddressNo_Work: _RSCompanyAddress,
                Nationality: _RSNationality,
                ResaleID: _ResaleID,
                ResaleDate: _ResaleDate,
                ResaleAt: _ResaleAt,
                ResaleStatus: 2,
                RSContractID: _RVCusID,
                SalePrice: _SalePrice,
                ContractDiscount: _SaleDiscount,
                TransferDiscount: _TranferDiscount,
                SaleAmt: _NetPrice,
                SalePerSqm: _PricePerSQM,
                PriceBFVat: _PriceBeforeVat,
                VatAmt: _Vat,
                NetPrice: _PriceIncVat,
                Creator: EmpID,
                Reviser: EmpID,
                IsDelete: false,
                DepositID: _DepositID,
                CreateBy: EmpID,
                ModifyBy: EmpID,
                DocType: _DocRef,
                Tel2: _TelMobile,
                Email: _Email,
                ReservationsID: _ReservationsID,
                RVCustomerID: _RVCusID,
                Pay_Cash: _AmountCash,
                Pay_Cashier: _AmountCashier,
                Pay_CashierBank: _CashierBank,
                Pay_CashierNo: _CashierNo,
                Pay_CashierDate: _CashierNoDate,
                Pay_TransferCash: _AmounCashTransfer,
                Pay_TransferBankNo: _BankNoCashTransfer,
                Pay_TransferCashDate: _CashTransferDate,
                Pay_TransferBankName: _BankNameCashTransfer,
                TransferFeeAmt: _TransferFeeAmt,
                ContactAmt: _ContactAmt,

            }, function (result) {

                if (result != "") {
                    var sp = result.split("|");
                    CheckRV_RNSave = 0;
                        $('#controlDupplicate').val(0);

                    if (_IsPrint == true) {
                        var id = sp[1];
                        var url = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RS_RESALE_Contact" + "&objName=" + "ResaleID" + "&objValue=" + id;
                        loadNewPage(url);
                        //resale

                        var url2 = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RS_RESALE_Temporary_Reciept" + "&objName=" + "ResaleID" + "&objValue=" + id;
                        loadNewPage(url2);

                        $('#myModalResale').modal('hide');
                        saveFileUpload(sp[1], ".clsRSAttachFile", "RS");
                        LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), sp[1], null, null);
                        swal("Save Complete!!!", "", "success");
                    }
                    else {
                        $('#myModalResale').modal('hide');
                        saveFileUpload(sp[1], ".clsRSAttachFile", "RS");
                        LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), sp[1], null, null);
                        swal("Save Complete!!!", "", "success");
                    }
                }
                else {
                    $('#controlDupplicate').val(0);
                    ShowHideLoading(0);
                    CheckRV_RNSave = 0;
                    $('#btnSave').attr("disabled", false);
                    swal("Save is not Complete!!!", "", "warning");
                    //swal("Cancel It's Not Complete!!!", "", "success");
                }
            });

        }

        function saveFileUpload(_ID, _type, _class) {
            var _objAttachFile = $(_class);
            $.each(_objAttachFile, function (i, e) {

                var _objName = e.id;
                var fileData = new FormData();
                var fileUpload = $("#" + _objName).get(0);
                var files = fileUpload.files;
                var _Running = $("#" + _objName).data("running");


                if (files.length > 0) {
                    for (var i = 0; i < files.length; i++) {
                        fileData.append(files[i].name, files[i]);
                    }
                    fileData.append("DepositID", _ID);
                    fileData.append("Running", _Running);
                    fileData.append("Type", _type);
                }
                $.ajax({

                    url: '@Url.Action("FileUploadHandler", "DMPS_DepositRoom")',
                    type: "POST",
                    contentType: false, // Not to set any content header
                    processData: false, // Not to process data
                    ////data: fileData,
                    data: fileData,
                    success: function (result2) {
                        // alert(result2);
                    },
                    error: function (err) {
                        // alert(err.statusText);
                    }
                });
            });

        }

        function SaveRVTable(_IsPrint, _IsDelete, _IsCancel, _IsContact) {
            var EmpID = $("#EmployeeID").data("emp-id");

            var _DSCustID = $('#txtDSCustomerID').val();
            var _DepositID = $('#txtDSID').val();
            var _UnitID = $('#txtUnitID').val();
            var _RTCustID = $('#txtRVCustomerID').val();
            var _RVID = $('#txtRVID').val();

            var _DocRef = $('#txtDocsRef').val();


            var _DocRef = $('#txtDocsRef').val();
            var _DocDate = ConvertString2DatetimeFormat($('#ddlDocDate').val());

            /// alert(_DocDate);
            var _DocAt = $('#txtDocAt').val();




            var _RTName = $('#txtCus_Name').val();
            var _RTCardID = $('#txtCus_IDCard').val();
            var _RTAge = $('#txtCus_Age').val();
            var _RTCardIssue = ConvertString2DatetimeFormat($('#ddlCus_CardDate').val());
            var _RTCardExpire = ConvertString2DatetimeFormat($('#ddlCus_CardExpire').val());
            var _RTCardFrom = $('#ddlCardFrom').val();
            var _RTAddressNo = $('#txtCus_Address').val();
            var _RTMoo = $('#txtCus_Moo').val();
            var _RTSoi = $('#txtCus_Soi').val();
            var _RTRoad = $('#txtCus_Road').val();

            var _RTSubDistinct = "";
            var _RTDistinct = "";
            var _RTProvince = "";
            var _RTZipcode = "";

            if ($('#chkRVisForeign').is(':checked') == true) {
                _RTSubDistinct = '';
                _RTDistinct = '';
                _RTProvince = '';
                _RTZipcode = '';
            }
            else {
                 _RTSubDistinct = $('#ddlSubDistrict').val();
                 _RTDistinct = $('#ddlDistrict').val();
                 _RTProvince = $('#ddlProvince').val();
                 _RTZipcode = $('#txtCus_Zipcode').val();
            }


            var _RTTel = $('#txtCus_Tel').val();

            var _TelMobile = $('#txtTelCellPhone').val();
            var _Email = $('#txtEmail').val();

            var _RTNationality = $('#txtCus_Nationality').val();
            var _RTCompanyAddress = $('#txtCus_Company').val();


            var _CustomerTypeId = 0;
            var _ReservationsStatus = 0;


            var _DueDateSignContact = ConvertString2DatetimeFormat($('#ddlDueDateSignContact').val());

            if ($('#chkRVRent').is(':checked') == true) {

                var _ContractSdate = ConvertString2DatetimeFormat($('#dllContractSdate').val());
                var _ContractEdate = ConvertString2DatetimeFormat($('#dllContractEdate').val());
                var _RVRentPeriod = $('#txtRVRentPeriod').val()

                var _Reserve_RentPrice = $('#txtReserve_RentPrice').val().replace(/,\s?/g, "");
                var _DayOfDue = $('#txtDayOfDue').val()
                var _Reserve_Deposit = $('#txtReserve_Deposit').val().replace(/,\s?/g, "");
                var _Reserve_InsuranceAmte = $('#txtReserve_InsuranceAmte').val().replace(/,\s?/g, "");

                var _InsuranceQty = $('#txtReserve_InsuranceQty').val();
                var _DepositQty = $('#txtReserve_DepositQty').val();

                var _ReservationsAmt = $('#txtReserve_Amt').val().replace(/,\s?/g, "");

                _CustomerTypeId = 2;
                _ReservationsStatus = 4;
            }
            else {

                var _DueTransfer = ConvertString2DatetimeFormat($('#dllDueTransfer').val());
                var _ResalePrice = $('#txtReserve_ResalePrice').val().replace(/,\s?/g, "");
                var _ResalePricePerSQM = $('#txtReserve_ResalePricePerSQM').val().replace(/,\s?/g, "");
                //var _ResaleAmount = $('#txtReserve_ResaleAmount').val().replace(/,\s?/g, "");
                var _ResaleRemainPrice = $('#txtReserve_ResaleRemainPrice').val().replace(/,\s?/g, "");
                var _RSContactAmount = $('#txtReserve_RSContactAmount').val().replace(/,\s?/g, "");

                var _ReservationsAmt = $('#txtReserve_ResaleAmount').val().replace(/,\s?/g, "");

                _CustomerTypeId = 3;
                _ReservationsStatus = 6;

            };

            var _AmountCash = $('#txtReserve_AmountCash').val().replace(/,\s?/g, "");

            var _AmountCashier = $('#txtReserve_AmountCashier').val().replace(/,\s?/g, "");
            var _AmounCashTransfer = $('#txtReserve_AmounCashTransfer').val().replace(/,\s?/g, "");


            var _CashierBank = $('#ddl_CashierBank').val();
            var _CashierNo = $('#txtReserve_CashierNo').val();
            var _CashierNoDate = ConvertString2DatetimeFormat($('#dllCashierDate').val());

            var _BankNameCashTransfer = $('#txtReserve_BankNameCashTransfer').val();
            var _BankNoCashTransfer = $('#txtReserve_BankNoCashTransfer').val();
            var _CashTransferDate = ConvertString2DatetimeFormat($('#dllCashTransferDate').val());


            var _Reamerk = $('#txtRemark').val();



            var _IsForeign = false;
            if ($('#chkRVisForeign').is(':checked') == true) { _IsForeign = true };

            var _IsUnExpireCard = false;
            if ($('#ChkUnExpireCard').is(':checked') == true) { _IsUnExpireCard = true };


            var _IsJuristic = false;
            var _JuristicPerson = "";
            if ($("#rdo2").is(":checked")) {
                _IsJuristic = true;
                _JuristicPerson = $('#txtcommittee').val();
            } else {
                _IsJuristic = false;
                _JuristicPerson = "";
            }

            var url = '@Url.Action("ReservationsTable", "DMPS_ReservationsRoom")';

            $.post(url, {
                ContactsID: _RTCustID,
                CustomerTypeId: _CustomerTypeId,
                FirstName: _RTName,
                Age: _RTAge,
                CitizenID: _RTCardID.replace(" ", "").replace("-", "").toLowerCase(),
                CitizenIssue: _RTCardIssue,
                CitizenExp: _RTCardExpire,
                UnExpireIDCard: _IsUnExpireCard,
                CitizenProvince: _RTCardFrom,
                Tel1: _RTTel,
                AddressNo: _RTAddressNo,
                Moo: _RTMoo,
                Soi: _RTSoi,
                Road: _RTRoad,
                SubDistrict: _RTSubDistinct,
                District: _RTDistinct,
                Province: _RTProvince,
                ZipCode: _RTZipcode,
                AddressNo_Work: _RTCompanyAddress,
                Nationality: _RTNationality,
                Creator: EmpID,
                Reviser: EmpID,
                IsDelete: _IsDelete,
                DepositID: _DepositID,
                CreateBy: EmpID,
                ModifyBy: EmpID,
                Tel2: _TelMobile,
                Email: _Email,
                ReservationsID: _RVID,
                ReservationsDate: _DocDate,
                ReservationsAt: _DocAt,
                DocRef: _DocRef,
                ReservationsType: _CustomerTypeId,
                ReservationsStatus: _ReservationsStatus,
                DueDateSignContact: _DueDateSignContact,
                RentPeriod: _RVRentPeriod,
                RentStartDate: _ContractSdate,
                RentEndDate: _ContractEdate,
                RentPrice: _Reserve_RentPrice,
                DayofDue: _DayOfDue,
                RoomInsuranceAmt: _Reserve_InsuranceAmte,
                RoomDepositAmt: _Reserve_Deposit,
                TransferDate: _DueTransfer,
                SaleAmt: _ResalePrice,
                SalePerSqm: _ResalePricePerSQM,
                ReservationsAmt: _ReservationsAmt,
                RoomInsuranceQty: _InsuranceQty,
                RoomDepositQty: _DepositQty,
                ContactAmount: _RSContactAmount,
                //CashAmount:_ResaleAmount,
                RemainingAmount: _ResaleRemainPrice,
                Pay_Cash: _AmountCash,
                Pay_Cashier: _AmountCashier,
                Pay_CashierBank: _CashierBank,
                Pay_CashierNo: _CashierNo,
                Pay_CashierDate: _CashierNoDate,
                Pay_TransferCash: _AmounCashTransfer,
                Pay_TransferBankNo: _BankNoCashTransfer,
                Pay_TransferCashDate: _CashTransferDate,
                Pay_TransferBankName: _BankNameCashTransfer,
                Remark: _Reamerk,
                Creator: EmpID,
                Reviser: EmpID,
                DepositID: _DepositID,
                IsCancel: _IsCancel,
                IsContact: _IsContact,
                IsForeign: _IsForeign,
                IsJuristic: _IsJuristic,
                JuristicPerson: _JuristicPerson,

            }, function (result) {

                if ($("#ddlDS_UnitType").val() == 8) {
                    if (result != "") {
                        var sp = result.split("|");

                        SaveShopDateils(sp[1]);
                    }

                }

                if (result != "") {

                    var sp = result.split("|");

                    $('#controlDupplicate').val(0);

                    if (_IsPrint == 1) {
                        //Functions Print & Save
                        CheckSave = 0;
                        //var url1 = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RV_RENT_CONTACT_001" + "&objName=" + "ReservationsID" + "&objValue=" + sp[1];
                        //var url1 = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RV_RENT_2020_Contact" + "&objName=" + "ReservationsID" + "&objValue=" + sp[1];
                        var url1 = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RV_RESALE_Contact" + "&objName=" + "RVID" + "&objValue=" + sp[1];
                        loadNewPage(url1);

                        setTimeout(function () {
                            //var url2 = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RV_RENT_Temp_Reciept_001" + "&objName=" + "ReservationsID" + "&objValue=" + sp[1];
                            var url2 = '@Url.Action("ReportViewer", "Report")' + "?ReportCode=" + "RV_RESALE_Temporary_Reciept" + "&objName=" + "ReservationsID" + "&objValue=" + sp[1];
                            loadNewPage(url2);
                        }, 800);


                        $('#myModal').modal('hide');
                        LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), sp[1], null, null);
                        swal("Save Complete!!!", "", "success");
                    }
                    else {
                        CheckSave = 0;
                        $('#myModal').modal('hide');
                        LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), sp[1], null, null);
                        swal("Save Complete!!!", "", "success");
                    }
                }
                else {
                    $('#controlDupplicate').val(0);
                    ShowHideLoading(0);
                    CheckSave = 0;
                    $('#btnSave').attr("disabled", false);
                    swal("Save is not Complete!!!", "", "warning");
                    //swal("Cancel It's Not Complete!!!", "", "success");
                }
            });

        }

        function SaveShopDateils(_RVID) {
            var url = '@Url.Action("SaveShopDateils", "DMPS_ReservationsRoom")';

            var _EmpID = $('#EmployeeID').data("emp-id");

            var _ShopName = "";
            if ($("#ddlDS_UnitType").val() == 8) {
                _ShopName = $("#txtNameShop").val();
            }
            var _ShopAim = "";
            if ($("#ddlDS_UnitType").val() == 8) {
                _ShopAim = $("#txtAimShop").val();
            }

            $.post(url, {
                _RVID: _RVID,
                _EmpID: _EmpID,
                _ShopName: _ShopName,
                _ShopAim: _ShopAim,

            }, function (result) {


            });
        }

        function LoadShopDateils(_ReservationsID) {

            var url = '@Url.Action("LoadShopDateils", "DMPS_ReservationsRoom")';

            $.post(url, {
                _ReservationsID: _ReservationsID,

            }, function (result) {
                var obj = $.parseJSON(result);

                $("#txtAimShop").val(obj.ShopAim);
                $("#txtNameShop").val(obj.ShopName);


                $("#showAimShop").val(obj.ShopAim);
                $("#showNameShop").val(obj.ShopName);


            });
        }

        function CancelRVTable(_RVID, _inputValue, _DSID) {

            var url = '@Url.Action("CancelReservationsTable", "DMPS_ReservationsRoom")';
            $.post(url, {
                Reviser: EmpID,
                ReservationsID: _RVID,
                IsCancel: true,
                Remark_Cancel: _inputValue,
                DepositID: _DSID,
            }, function (result) {


                if (result != "") {
                    LoadDataListView($('#RowAdmin').val(), $("#EmployeeID").data("emp-id"), result, null, null);
                    swal("Cancel Complete!!!", "", "success");
                }
                else {
                    $('#btnRV_Save').attr("disabled", false);
                    //swal("Warnning !", _Validate, "warning");
                    swal("Cancel is not Complete!!!", "", "warning");
                }

            });



        }


        function GetNewDocuments(_DocType) {

            var _DocNoNew;
            var _YYYY = (new Date()).getFullYear();
            var _MM = (new Date()).getMonth() + 1;
            var _DD = (new Date()).getDay() + 1;

            if (_DD < 10) { _DD = "0" + _DD };
            if (_MM < 10) { _MM = "0" + _MM };

            if (_DocType == 1) {
                _DocNoNew = "SUP" + "-" + _YYYY + _MM + _DD + "-" + "xxxx"
            }
            else if (_DocType == 2) {

                _DocNoNew = "RT" + "-" + _YYYY + _MM + "-" + "xxxx"
            }
            else if (_DocType == 3) {
                _DocNoNew = "RS" + "-" + _YYYY + _MM + "-" + "xxxx"

            }
            else if (_DocType == 4) {
                _DocNoNew = "RV" + "-" + _YYYY + _MM + "-" + "xxxx"

            }
            return _DocNoNew;

        }


        function ValidateData() {


            if ($("#txtCus_IDCard").val().trim() == "") { return "กรุณากรอก เลขที่บัตรประชาชน !" }
            if ($("#txtCus_Name").val().trim() == "") { return "กรุณากรอก ชื่อ - สกุล !" }
            if ($("#txtCus_Age").val().trim() == "") { return "กรุณากรอก อายุ !" }
            if ($("#txtCus_Nationality").val().trim() == "") { return "กรุณากรอก สัญชาติ !" }
            //if (ConvertString2DatetimeFormat($('#ddlCus_CardExpire').val()) >= ConvertString2DatetimeFormat($('#ddlCus_CardDate').val())) { return "วันหมดอายุวันที่ ไม่สามารถน้อยกว่าหรือเท่ากับ วันที่ออกเมื่อวันที่ (บัตรประชาชน) !" }

            if ($('#chkRVisForeign').is(':checked') == false)
            {
                if ($("#ddlCardFrom").val() == "" || $("#ddlCardFrom").val() == 0) { return "กรุณาเลือก บัตรประชาขนออก ณ จังหวัด !" }
                if ($("#ddlProvince").val() == "" || $("#ddlProvince").val() == 0) { return "กรุณาเลือก จังหวัด (ที่อยู่) !" }
                if ($("#ddlDistrict").val() == "" || $("#ddlDistrict").val() == 0) { return "กรุณาเลือก เขต/อำเภอ (ที่อยู่) !" }
                if ($("#ddlSubDistrict").val() == "" || $("#ddlSubDistrict").val() == 0) { return "กรุณาเลือก ตำบล/แขวง (ที่อยู่) !" }
            }

            if ($("#txtCus_Address").val().trim() == "") { return "กรุณากรอก ที่อยู่ !" }


            if ((!$("#rdo1").is(':checked')) && (!$("#rdo2").is(':checked'))) { return "กรุณาเลือก ประเภทลูกค้า !" }


            if ($("#txtCus_Zipcode").val().trim() == "") { return "กรุณากรอก รหัสไปรษณีย์ !" }
            if ($("#txtCus_Tel").val().trim() == "") { return "กรุณากรอก เบอร์โทร !" }
            if ($("#txtCus_Company").val().trim() == "") { return "กรุณากรอก สถานที่ทำงาน !" }

            if ($("#rdo2").is(':checked')) {
                if ($("#txtcommittee").val().trim() == "") { return "กรุณากรอก กรรมการผู้มีอํานาจกระทําการแทนบริษัท  !" }
            }

            if ($("#ddlDS_UnitType").val() == 8) {
                if ($("#txtNameShop").val().trim() == "") { return "กรุณากรอก ชื่อร้าน !" }
                if ($("#txtAimShop").val().trim() == "") { return "กรุณากรอก วัตถุประสงค์ !" }
            }


            if ($('#chkRVRent').is(':checked') == true) {
                if ($("#txtRVRentPeriod").val().trim() == "0" || $("#txtRVRentPeriod").val().trim() == 0) { return "กรุณากรอก ระยะเวลาเช่า !" }
                if ($("#txtReserve_RentPrice").val().trim() == "0" || $("#txtReserve_RentPrice").val().trim() == 0) { return "กรุณากรอก อัตราค่าเช่า !" }

                if ($("#txtDayOfDue").val().trim() == "0" || $("#txtDayOfDue").val().trim() == 0) { return "กรุณากรอก ทุกวันที่ !" }


                if ($("#txtReserve_InsuranceQty").val().trim() == "0" || $("#txtReserve_InsuranceQty").val().trim() == 0) { return "กรุณากรอก จำนวนเงินประกัน !" }
                if ($("#txtReserve_InsuranceAmte").val().trim() == "0" || $("#txtReserve_InsuranceAmte").val().trim() == 0) { return "กรุณากรอก จำนวนเงิน(ประกัน) : !" }


                if ($("#txtReserve_DepositQty").val().trim() == "0" || $("#txtReserve_DepositQty").val().trim() == 0) { return "กรุณากรอก จำนวนค่าเช่าล่วงหน้า !" }
                if ($("#txtReserve_Deposit").val().trim() == "0" || $("#txtReserve_Deposit").val().trim() == 0) { return "กรุณากรอก จำนวนเงิน(ค่าเช่าล่วงหน้า) : !" }

                if ($("#txtReserve_Amt").val().trim() == "0" || $("#txtReserve_Amt").val().trim() == 0) { return "กรุณากรอก ชำระเงินจอง !" }


                //if ($("#txtReserve_RentPrice").val().trim() == "0" || $("#txtReserve_RentPrice").val().trim() == 0) { return "กรุณากรอก ค่าเช่าล่วงหน้า !" }

                //alert(Number($("#txtReserve_AmountCash").val().replace(/,\s?/g, "")) + Number($("#txtReserve_AmountCashier").val().replace(/,\s?/g, "")) + Number($("#txtReserve_AmounCashTransfer").val().replace(/,\s?/g, "")));
                //alert(Number($("#txtReserve_Deposit").val().replace(/,\s?/g, "")));

                if (Number($("#txtReserve_AmountCash").val().replace(/,\s?/g, "")) + Number($("#txtReserve_AmountCashier").val().replace(/,\s?/g, "")) + Number($("#txtReserve_AmounCashTransfer").val().replace(/,\s?/g, "")) != Number($("#txtReserve_Amt").val().replace(/,\s?/g, ""))) { return "ยอดชำระเงินมัดจำ ไม่เท่ากับ ยอดชำระเงินจอง !" }

            }
            else {
                if ($("#txtReserve_ResalePrice").val().trim() == "0" || $("#txtReserve_ResalePrice").val().trim() == 0) { return "กรุณากรอก ราคาขาย !" }
                if ($("#txtReserve_ResalePricePerSQM").val().trim() == "0" || $("#txtReserve_ResalePricePerSQM").val().trim() == 0) { return "กรุณากรอก ราคาขาย / ตรม !" }
                if ($("#txtReserve_RSContactAmount").val().trim() == "0" || $("#txtReserve_RSContactAmount").val().trim() == 0) { return "กรุณากรอก ชำระเงิน(วันทำสัญญา) !" }

                if ($("#txtReserve_ResaleRemainPrice").val().trim() == "0" || $("#txtReserve_ResaleRemainPrice").val().trim() == 0) { return "กรุณากรอก ชำระค่าห้องชุดที่เหลือ !" }

                if ($("#txtReserve_ResaleAmount").val().trim() == "0" || $("#txtReserve_ResaleAmount").val().trim() == 0) { return "กรุณากรอก ชำระเงินจองจำนวน !" }


                if (Number($("#txtReserve_AmountCash").val().replace(/,\s?/g, "")) + Number($("#txtReserve_AmountCashier").val().replace(/,\s?/g, "")) + Number($("#txtReserve_AmounCashTransfer").val().replace(/,\s?/g, "")) != Number($("#txtReserve_ResaleAmount").val().replace(/,\s?/g, ""))) { return "ยอดชำระเงินมัดจำ ไม่เท่ากับ ยอดชำระเงินจอง !" }
            }

            return "";

        }

        function ValidateRental() {

            var result = "";


            //var currdate = dateFormat(new Date(), "dd/mm/yyyy");
            //var vSTime = $('#ddlStime').val();
            // Run at Server
            //var aa = dateFormat(new Date(ConvertString2DatetimeFormat(vWorkDate)), "dd/mm/yyyy");

            // Run at My Computer
            //var aa = dateFormat(new Date(ConvertString2DatetimeFormatInDate(vWorkDate)), "dd/mm/yyyy");

            if ($("#txtCus_IDCard").val().trim() == "") { return "กรุณากรอก เลขที่บัตรประชาชน !" }
            if ($("#txtCus_Name").val().trim() == "") { return "กรุณากรอก ชื่อ - สกุล !" }
            if ($("#txtCus_Age").val().trim() == "") { return "กรุณากรอก อายุ !" }
            if ($("#txtCus_Nationality").val().trim() == "") { return "กรุณากรอก สัญชาติ !" }
            //if ($("#txtCus_CardFrom").val().trim() == "") { return "กรุณากรอก บัตรประชาขนออก ณ จังหวัด !" }
            if ($("#ddlCardFrom").val().trim() == "" || $("#ddlCardFrom").val().trim() == 0) { return "กรุณาเลือก บัตรประชาขนออก ณ จังหวัด !" }
            if ($("#txtCus_Address").val().trim() == "") { return "กรุณากรอก ที่อยู่ !" }
            //if ($("#txtMoo").val().trim() == "") { return "กรุณากรอก หมู่ !" }
            //if ($("#txtSoi").val().trim() == "") { return "กรุณากรอก ตรอก/ซอย !" }
            //if ($("#txtRoad").val().trim() == "") { return "กรุณากรอก ถนน !" }
            //if ($("#ddlProvince").val().trim() == "" || $("#ddlProvince").val().trim() == 0) { return "กรุณาเลือก จังหวัด !" }
            //if ($("#ddlDistrict").val().trim() == "" || $("#ddlDistrict").val().trim() == 0) { return "กรุณาเลือก เขต/อำเภอ !" }
            //if ($("#ddlSubDistrict").val().trim() == "" || $("#ddlSubDistrict").val().trim() == 0) { return "กรุณาเลือก ตำบล/แขวง !" }
            if ($("#txtCus_Zipcode").val().trim() == "") { return "กรุณากรอก รหัสไปรษณีย์ !" }
            if ($("#txtCus_Tel").val().trim() == "") { return "กรุณากรอก เบอร์โทร !" }
            if ($("#txtCus_Company").val().trim() == "") { return "กรุณากรอก สถานที่ทำงาน !" }



            return "";
        }

        function ShowModalBlindingRent(_DepositID, _DSContactID, _UnitID, _RentID, _RVID, _RVCUST) {

            var _CopyContact = false;

            url = '@Url.Action("GetRentalData", "DMPS_ReservationsRoom")';

            $.post(url, {
                DepositID: _DepositID,
                DSContactID: _DSContactID,
                UnitID: _UnitID,
                RentID: _RentID,
                ReservationsID: _RVID,
                RVCustomerID: _RVCUST,
            }, function (result) {
                var obj = $.parseJSON(result);


                //// :::::: หัวเอกสาร
                if (obj[4][0].RentNo == "New") { $('#lbl_RNDocNo').text(GetNewDocuments(2)); }
                else { $('#lbl_RNDocNo').text(obj[4][0].RentNo); }
                $('#txt_RNDocAt').val(obj[7][0].ReservationsAt);
                $('#ddl_RNDocDate').val(ConvertJson2DatetimeFormat2(obj[4][0].RentDate, "dd/mm/yyyy"));
                $('#lbl_RNDocumentStatusDisplay').text(obj[4][0].RentStatus)
                if (obj[4][0].RentStatus == 0 || obj[4][0].RentStatus == null) { $('#lbl_RNDocumentStatusDisplay').text("New"); }
                if (obj[4][0].RentStatus == 1) { $('#lbl_RNDocumentStatusDisplay').text("ทำสัญญา (เช่า)"); }
                if (obj[4][0].RentStatus == 2) { $('#lbl_RNDocumentStatusDisplay').text("ทำสัญญา (ขาย)"); }
                if (obj[4][0].RentStatus == 3) { $('#lbl_RNDocumentStatusDisplay').text("จบสัญญา (เช่า)"); }
                if (obj[4][0].RentStatus == 5) { $('#lbl_RNDocumentStatusDisplay').text("ยกเลิก"); }

                $('#txt_RNDocsRef').val(obj[4][0].DocRef);
                //////0 Deposit
                //////1 Contract
                //////2 unit
                //////3 unitDetails
                //////4 rent
                //////5 BankContact
                //////6 CRM_Contact (CustType = 2 for cust Rent)
                //////7 Reservations


                //obj.Add(lstDeposit);0
                //obj.Add(lstContract);1
                //obj.Add(lstUnit);2
                //obj.Add(lstUnitDetails);3
                //obj.Add(lstRent);4
                //obj.Add(lstBankContact);5
                //obj.Add(lstRentContact);6
                //obj.Add(lstReservations);7

                //// Hide Data
                $('#txt_RNDSCustID').val(obj[1][0].ContactsID)
                $('#txt_RNDepositID').val(obj[0][0].DepositID)
                $('#txt_RNUnitID').val(obj[2][0].UnitsID)
                $('#txt_RNRTCustID').val(obj[6][0].ContactsID)
                $('#txt_RNRentID').val(obj[4][0].RentID);
                $('#txt_RNReservationsID').val(_RVID);
                $('#txt_RNRVCusID').val(_RVCUST);


                ///ข้อมูลผู้ให้เช่า (รายละเอียดตามบัตรประชาชน)
                $('#txt_RNName').val(obj[1][0].NameFullPre);
                $('#txt_RNIDCard').val(obj[1][0].CitizenID);
                $('#txt_RNTel').val(obj[1][0].Tel1);

                /////รายละเอียดบัญชีธนาคาร

                $("#ddl_RNBank").select2("val", obj[5][0].BankID);
                //$("#ddl_AccountType").select2("val", obj[5][0].BankTypeID);
                $('#txt_RNAccountNo').val(obj[5][0].BankNo);
                $('#txt_RNAccountName').val(obj[5][0].BankName);

                /////ข้อมูลผู้เช่า (รายละเอียดตามบัตรประชาชน)
                $('#txt_RNCus_Name').val(obj[6][0].NameFullPre);
                $('#txt_RNCus_IDCard').val(obj[6][0].CitizenID);
                $('#txt_RNCus_Age').val(obj[6][0].Age);
                $('#ddl_RNCus_CardDate').val(ConvertJson2DatetimeFormat2(obj[6][0].CitizenIssue, "dd/mm/yyyy"));
                $('#ddl_RNCus_CardExpire').val(ConvertJson2DatetimeFormat2(obj[6][0].CitizenExp, "dd/mm/yyyy"));
                $('#txt_RNCus_Nationality').val(obj[6][0].Nationality);
                $('#ddl_RNCardFrom').select2("val", obj[6][0].CitizenProvince)


                if (obj[6][0].UnExpireIDCard == true) {
                    $('.Chk_RNUnExpireCard').iCheck('check');
                }
                else {
                    $('.Chk_RNUnExpireCard').iCheck('uncheck');
                }


                if (obj[6][0].IsForeign == true) {
                    $('#chkRVisForeign').iCheck('check');
                }
                else {
                    $('#chkRVisForeign').iCheck('uncheck');
                }




                if (obj[6][0].UnExpireIDCard == true) {
                    $('.Chk_RNUnExpireCard').iCheck('check');
                }
                else {
                    $('.Chk_RNUnExpireCard').iCheck('uncheck');
                }


                $('#txt_RNCus_Address').val(obj[6][0].AddressNo);
                $('#txt_RNCus_Moo').val(obj[6][0].Moo);
                $('#txt_RNCus_Soi').val(obj[6][0].Soi);
                $('#txt_RNCus_Road').val(obj[6][0].Road);

                if (obj[6][0].Province != 0) {
                    $('#ddl_RNProvince').select2("val", obj[6][0].Province);
                    setTimeout(function () { $('#ddl_RNDistrict').select2("val", obj[6][0].District); }, 1000);
                    setTimeout(function () { $('#ddl_RNSubDistrict').select2("val", obj[6][0].SubDistrict); }, 1500);
                }
                else {
                    $('#ddl_RNProvince').select2("val", "");
                    $('#ddl_RNDistrict').select2("val", "");
                    $('#ddl_RNSubDistrict').select2("val", "");
                }

                $('#txt_RNCus_Zipcode').val(obj[6][0].ZipCode);
                $('#txt_RNCus_Tel').val(obj[6][0].Tel1);
                $('#txt_RNCus_Company').val(obj[6][0].AddressNo_Work);
                $('#txt_RNTelCellPhone').val(obj[6][0].Tel2);
                $('#txt_RNEmail').val(obj[6][0].Email);


                /////ข้อมูลIsJuristic
                var _IsJuristic = obj[6][0].IsJuristic;
                if (_IsJuristic == true) {
                    var check = $('#type2').prop('checked', true);
                    if (check) {
                        $('#type2').prop('checked', true);
                        $('#showNameRN').html('ชื่อบริษัท :');
                        $('#showIDCardRN').html('ทะเบียนนิติบุคคลเลขที่  :');
                        $('#showcommittee').show();
                    }

                    //else {
                    //    $('#showNameRN').html('ชื่อ-สกุล :');
                    //    $('#showIDCardRN').html('เลขที่บัตรประชาชน :');
                    //    $('#showcommittee').hide();
                    //}

                }
                else if (_IsJuristic == false) {
                    $('#type1').prop('checked', true);
                    $('#showNameRN').html('ชื่อ-สกุล :');
                    $('#showIDCardRN').html('เลขที่บัตรประชาชน :');
                    $('#showcommittee').hide();
                }
                //else if (_IsJuristic == null) {
                //    $('#txtNameRN').html('ชื่อ-สกุล :');
                //    $('#txtIDCardRN').html('เลขที่บัตรประชาชน :');
                //    $('#committee').hide();
                //}

                $('#displaycommittee').val(obj[6][0].JuristicPerson);

                /////รายละเอียดห้อง

                //alert(obj[3][0].Building);

                $('#ddl_RNRentType').select2("val", obj[0][0].DSTypeID);
                $('#ddl_RNDeveloper').select2("val", obj[0][0].DeveloperID);
                $('#ddl_RNProject').select2("val", obj[0][0].ProjectID);
                $('#txt_RNFloor').val(obj[3][0].Floor);
                $('#txt_RNUnits').val(obj[2][0].UnitsCode);
                $('#txt_RNAddressNo').val(obj[3][0].RoomNo);
                $("#ddl_RNDS_UnitType").select2("val", obj[3][0].RoomType);
                //$('#txtRoomType').val(obj[3][0].RoomType);
                $('#txt_RNRoomArea').val(obj[3][0].RoomArea);
                $('#txt_RNRoomAddress').val(obj[0][0].RoomAddress);
                $('#txt_RNContractPeriod').val(obj[7][0].RentPeriod);
                $('#txt_RNContractSdate').val(ConvertJson2DatetimeFormat2(obj[7][0].RentStartDate, "dd/mm/yyyy"));
                $('#txt_RNContractEdate').val(ConvertJson2DatetimeFormat2(obj[7][0].RentEndDate, "dd/mm/yyyy"));
                $('#txt_RNRoomAddress').val(obj[0][0].ProjectAddress);
                $('#txt_RNBuilding').val(obj[3][0].Building)



                /////รายละเอียดการชำระเงินค่าเช่า / ค่าใช้จ่ายต่าง ๆ
                $('#txt_RNRentPrice').val(formatNumber(obj[7][0].RentPrice));
                $('#txt_RNDayOfDue').val(obj[7][0].DayofDue);

                /////รายละเอียดเงินประกัน
                $('#txt_RNRoomInsurance').val(obj[7][0].RoomInsuranceQty);
                //$('#txt_RNRoomInsurancePrice').val(formatNumber(obj[7][0].RoomInsuranceAmt));
                $('#txt_RNRoomInsurancePrice').val(ConvertString2DecimalFormat(parseFloat(obj[7][0].RoomInsuranceAmt).toFixed(2)));

                $('#txt_RNDepositRent').val(obj[7][0].RoomDepositQty);
                //$('#txt_RNDepositRentPrice').val(formatNumber(obj[7][0].RoomDepositAmt));
                $('#txt_RNDepositRentPrice').val(ConvertString2DecimalFormat(parseFloat(obj[7][0].RoomDepositAmt).toFixed(2)));

                //$('#txt_RNDepositMulctPrice').val(formatNumber(obj[4][0].MulctPrice));
                $('#txt_RNDepositMulctPrice').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].MulctPrice).toFixed(2)));

                $('#txt_RNRentFurnitureQty').val(formatNumber(obj[4][0].RoomFurnitureQty));
                //$('#txt_RNRentFurniture').val(formatNumber(obj[4][0].RoomFurnitureAmt));
                $('#txt_RNRentFurniture').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].RoomFurnitureAmt).toFixed(2)));
                $('#txt_RNDepositFur').val(formatNumber(obj[4][0].RoomFurnitureDepositQty));
                //$('#txt_RNDepositFurPrice').val(formatNumber(obj[4][0].RoomFurnitureDepositAmt));
                $('#txt_RNDepositFurPrice').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].RoomFurnitureDepositAmt).toFixed(2)));



                /////ประเภทการชำระเงินค่าใช้จ่ายต่าง ๆ
                //// ******* ประเภทการชำระเงินจอง เช่าห้องชุด/ซื้อห้องชุด

                /// เงินสด
                //$('#txtReserve_RNAmountCash').val(obj[4][0].Pay_Cash);
                $('#txtReserve_RNAmountCash').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].Pay_Cash).toFixed(2)));

                /// แคชเชียร์เช็ค
                //$('#txtReserve_RNAmountCashier').val(obj[4][0].Pay_Cashier);
                $('#txtReserve_RNAmountCashier').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].Pay_Cashier).toFixed(2)));
                $('#ddl_RNCashierBank').select2("val", obj[4][0].Pay_CashierBank);
                $('#txtReserve_RNCashierNo').val(obj[4][0].Pay_CashierNo);
                $('#dllRNCashierDate').val(ConvertJson2DatetimeFormat2(obj[4][0].Pay_CashierDate, "dd/mm/yyyy"));

                /// เงินโอนผ่านธนาคาร
                //$('#txtReserve_RNAmounCashTransfer').val(obj[4][0].Pay_TransferCash);
                $('#txtReserve_RNAmounCashTransfer').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].Pay_TransferCash).toFixed(2)));
                $('#txtReserve_RNBankNoCashTransfer').val(obj[4][0].Pay_TransferBankNo);
                $('#txtReserve_RNBankNameCashTransfer').val(formatNumber(obj[4][0].Pay_TransferBankName));
                $('#dllRNCashTransferDate').val(ConvertJson2DatetimeFormat2(obj[4][0].Pay_TransferCashDate, "dd/mm/yyyy"));



                ///ข้อมูลการตรวจสภาพห้องชุดของผู้เช่าก่อนเข้า / สิ้นสุดการเช่า
                $('#txt_RNCheckRoomRemarkDeposit').val(obj[4][0].CheckRoomRemarkRent);
                if (obj[4][0].RentID == 0) { SetCheckRoomList(_DepositID, 1); }
                else { SetCheckRoomList(obj[4][0].RentID, 2); }


                $('#btnPreviewFile').hide();
                $('#btnPreviewFile2').hide();
                $('#btnPreviewFile3').hide();

                $('#txtRoomInsurance').attr("disabled", false);
                $('#txtRoomInsurancePrice').attr("disabled", false);
                $('#txtDepositRent').attr("disabled", false);
                $('#txtDepositRentPrice').attr("disabled", false);
                $('#txtDepositMulctPrice').attr("disabled", false);
                $('#txtRentFurniture').attr("disabled", false);

                $('#txtRentFurniture').attr("disabled", false);
                $('#txtRentFurnitureQty').attr("disabled", false);
                $('#txtDepositFur').attr("disabled", false);
                $('#txtDepositFurPrice').attr("disabled", false);



                $('#txt_RNCus_IDCard').attr("disabled", true);
                $('#txt_RNCus_Name').attr("disabled", true);
                $('#txt_RNCus_Age').attr("disabled", true);
                $('#txt_RNCus_Age').attr("disabled", true);
                $('#txt_RNCus_Nationality').attr("disabled", true);
                $('#ddl_RNCardFrom').attr("disabled", true);
                $('#txt_RNCus_Address').attr("disabled", true);
                $('#txt_RNCus_Moo').attr("disabled", true);
                $('#txt_RNCus_Soi').attr("disabled", true);
                $('#txt_RNCus_Road').attr("disabled", true);
                $('#ddl_RNProvince').attr("disabled", true);


                $('#Chk_RNUnExpireCard').attr("disabled", true);
                $('#chkRNisForeign').attr("disabled", true);

                $('#txt_RNCus_Zipcode').attr("disabled", true);
                $('#txt_RNCus_Tel').attr("disabled", true);
                $('#txt_RNTelCellPhone').attr("disabled", true);
                $('#txt_RNEmail').attr("disabled", true);
                $('#txt_RNCus_Company').attr("disabled", true);

                //$('#txt_RNCus_IDCard').attr("disabled", false);
                //$('#txt_RNCus_Name').attr("disabled", false);
                //$('#txt_RNCus_Age').attr("disabled", false);
                //$('#txt_RNCus_Age').attr("disabled", false);
                //$('#txt_RNCus_Nationality').attr("disabled", false);
                //$('#ddl_RNCardFrom').attr("disabled", false);
                //$('#txt_RNCus_Address').attr("disabled", false);
                //$('#txt_RNCus_Moo').attr("disabled", false);
                //$('#txt_RNCus_Soi').attr("disabled", false);
                //$('#txt_RNCus_Road').attr("disabled", false);
                //$('#ddl_RNProvince').attr("disabled", false);
                //$('#ddl_RNDistrict').attr("disabled", false);
                //$('#ddl_RNSubDistrict').attr("disabled", false);
                //$('#txt_RNCus_Zipcode').attr("disabled", false);
                //$('#txt_RNCus_Tel').attr("disabled", false);
                //$('#txt_RNTelCellPhone').attr("disabled", false);
                //$('#txt_RNEmail').attr("disabled", false);
                //$('#txt_RNCus_Company').attr("disabled", false);

                $('#ddl_RNDistrict').attr("disabled", true);
                $('#ddl_RNSubDistrict').attr("disabled", true);
                if (obj[4][0].RentNo == "New") {
                    $('#btnSave').show();
                    $('#btnPrint').show();

                    $('#btnEndContract').hide();
                    $('#btnCancel').hide();

                    $('#divEndcontactDate').hide();
                }

                else if (obj[4][0].RentStatus == 3 && _CopyContact != 1) {
                    $('#btn_RNSave').hide();
                    $('#btn_RNPrint').hide();

                    $('#btn_RNEndContract').hide();
                    $('#btn_RNCancel').hide();

                    $('#divEndcontactDate').hide();
                }
                else {

                    if (_CopyContact == true) {
                        $('#btn_RNSave').show();
                        $('#btn_RNPrint').show();

                        $('#btn_RNEndContract').hide();
                        $('#btn_RNCancel').hide();
                        $('#divEndcontactDate').hide();


                    }

                    else {
                        $('#btn_RNSave').show();
                        $('#btn_RNPrint').show();
                        $('#btn_RNEndContract').hide();
                        $('#btnEndContract').hide();
                        $('#btn_RNCancel').hide();

                        $('#divEndcontactDate').hide();

                    }
                }


                if (_CopyContact == true) { LoadDataForPreview(0, "RT"); }
                else { LoadDataForPreview(obj[4][0].RentID, "RT"); }

                LoadShopDateils($('#txt_RNReservationsID').val(_RVID));


            });

            //$('#myModalRent').modal('show');
            $('#myModalRent').modal({
                backdrop: 'static',
                keyboard: false
            });
        }

        function SetCheckRoomList(_DSid, _CheckType) {
            var url = '@Url.Action("GetRoomCheck", "DMPS_DepositRoom")';
            $.post(url,
                {
                    DepositID: _DSid,
                    CheckType: _CheckType,
                }, function (result) {
                    var obj = $.parseJSON(result);

                    $('.clsCheckRoomID').iCheck('uncheck');
                    $('.clsCheckQty').val("");
                    $('.clsBrokenCheck').iCheck('uncheck');
                    $('.clsBrokenCheckQty').val("");


                    $.each(obj, function (i, e) {

                        var selecter = '#RCC' + e.CheckRoomID;
                        $(selecter).iCheck('check');

                        if (e.IsQty == true) {
                            $('#RCT' + e.CheckRoomID).val(e.CheckRoomQty);
                        }


                        ///Check Broken Items

                        var selecter2 = '#BCC' + e.CheckRoomID;

                        if (e.IsBroken == true)
                            $(selecter2).iCheck('check');

                        if (e.IsQty == true) {
                            if (e.BrokenRoomQty != 0 || e.BrokenRoomQty != null) $('#BCT' + e.CheckRoomID).val(e.BrokenRoomQty);
                        }
                        else { $('#BCT' + e.CheckRoomID).val("") }

                        //if (_CheckType == 2) { $(selecter2).attr("disabled", true); $('#BCT' + e.CheckRoomID).attr("disabled", true); }
                        //else { $(selecter2).attr("disabled", false); $('#BCT' + e.CheckRoomID).attr("disabled", false); }


                    });
                });
        }

        function ShowModalBlindingResale(_DepositID, _DSContactID, _UnitID, _ReSaleID, _RVID) {
            var url = '@Url.Action("GetResaleData", "DMPS_ReservationsRoom")';
            $.post(url, {
                DepositID: _DepositID,
                DSContactID: _DSContactID,
                UnitID: _UnitID,
                ResaleID: _ReSaleID,
                ReservationsID: _RVID,
            }, function (result) {
                var obj = $.parseJSON(result);
                //////0 Deposit
                //////1 Contract
                //////2 unit
                //////3 unitDetails
                //////4 Resale
                //////5 BankContact
                //////6 CRM_Contact (CustType = 2 for cust Rent)
                //////8 Reservations
                //////9 _RVContract cust



                if (obj[4].ResaleNo == "New") { $('#lblRSDocNo').text(GetNewDocuments(3)); }
                else { $('#lblRSDocNo').text(obj[4].ResaleNo); }
                $('#txtRSDocAt').val(obj[4].ResaleAt);
                $('#ddl_RNDocDate').val(ConvertJson2DatetimeFormat2(obj[4].ResaleDate, "dd/mm/yyyy"));
                $('#lblRSDocumentStatusDisplay').text(obj[4].ResaleStatus)
                if (obj[4].ResaleStatus == 0 || obj[4][0].ResaleStatus == null) { $('#lblRSDocumentStatusDisplay').text("New"); }
                if (obj[4].ResaleStatus == 1) { $('#lblRSDocumentStatusDisplay').text("ทำสัญญา (เช่า)"); }
                if (obj[4].ResaleStatus == 2) { $('#lblRSDocumentStatusDisplay').text("ทำสัญญา (ขาย)"); }
                if (obj[4].ResaleStatus == 3) { $('#lblRSDocumentStatusDisplay').text("จบสัญญา (เช่า)"); }
                if (obj[4].ResaleStatus == 5) { $('#lblRSDocumentStatusDisplay').text("ยกเลิก"); }

                $('#txtRSDocsRef').val(obj[4].DocRef);

                if (obj[4].ResaleNo == "New") {
                    //$('#lblRSDocNo').text(GetNewDocuments(3));
                    //$('#lblRSDocumentStatusDisplay').text(obj[4].ResaleNo);
                    $('#btn_RSCancel').hide();
                }
                else {
                    //$('#lblRSDocNo').text(obj[4].ResaleNo);
                    //$('#lblRSDocumentStatusDisplay').text(obj[7]);
                    $('#btn_RSCancel').show();
                }


                $('#ddlRSDocDate').val(ConvertJson2DatetimeFormat2(obj[4].ResaleDate, "dd/mm/yyyy"));
                $('#txtRSDocAt').val(obj[4].ResaleAt);

                $('#txtRSDocsRef').val(obj[4].DocRef)

                //// Hide Data
                $('#txt_RSDSCustID').val(_DSContactID);
                $('#txt_RSDepositID').val(_DepositID);
                $('#txt_RSUnitID').val(_UnitID);
                $('#txt_RSCustID').val(obj[6].ContactsID);
                $('#txt_RSResaleID').val(_ReSaleID);
                $('#txt_RSReservationsID').val(obj[8].ReservationsID);
                $('#txt_RSRVCusID').val(obj[8].RVCustomerID);

                ///ข้อมูลผู้ให้เช่า (รายละเอียดตามบัตรประชาชน)
                $('#txtRSName').val(obj[1].NameFullPre);
                $('#txt_RSIDCard').val(obj[1].CitizenID);
                $('#txt_RSTel').val(obj[1].Tel1);

                /////รายละเอียดบัญชีธนาคาร
                $("#ddl_RSBank").select2("val", obj[5].BankID);
                //$("#ddl_AccountType").select2("val", obj[5][0].BankTypeID);
                $('#txt_RSAccountNo').val(obj[5].BankNo);
                $('#txt_RSAccountName').val(obj[5].BankName);

                /////ข้อมูลผู้เช่า (รายละเอียดตามบัตรประชาชน)
                $('#txt_RSCus_Name').val(obj[9].NameFullPre);
                $('#txt_RSCus_IDCard').val(obj[9].CitizenID);
                $('#txt_RSCus_Age').val(obj[9].Age);
                $('#ddl_RSCus_CardDate').val(ConvertJson2DatetimeFormat2(obj[9].CitizenIssue, "dd/mm/yyyy"));
                $('#ddl_RSCus_CardExpire').val(ConvertJson2DatetimeFormat2(obj[9].CitizenExp, "dd/mm/yyyy"));


                if (obj[7].UnExpireIDCard == true) {
                    $('.cls_RSChkUnExpireCard').iCheck('check');
                }
                else {
                    $('.cls_RSChkUnExpireCard').iCheck('uncheck');
                }


                $('#txt_RSCus_Nationality').val(obj[9].Nationality);
                //$('#txtCus_CardFrom').val(obj[6].CitizenProvince);
                $('#ddl_RSCardFrom').select2("val", obj[9].CitizenProvince);
                $('#txt_RSCus_Address').val(obj[9].AddressNo);
                $('#txt_RSCus_Moo').val(obj[9].Moo);
                $('#txt_RSCus_Soi').val(obj[9].Soi);
                $('#txt_RSCus_Road').val(obj[9].Road);

                if (obj[9].Province != 0) {
                    $('#ddl_RSProvince').select2("val", obj[9].Province);
                    setTimeout(function () { $('#ddl_RSDistrict').select2("val", obj[9].District); }, 500);
                    setTimeout(function () { $('#ddl_RSSubDistrict').select2("val", obj[9].SubDistrict); }, 1000);
                }
                else {
                    $('#ddl_RSProvince').select2("val", "");
                    $('#ddl_RSDistrict').select2("val", "");
                    $('#ddl_RSSubDistrict').select2("val", "");
                }

                $('#txt_RSCus_Zipcode').val(obj[9].ZipCode);
                $('#txt_RSCus_Tel').val(obj[9].Tel1);
                $('#txt_RSCus_Company').val(obj[9].AddressNo_Work);

                $('#txt_RSTelCellPhone').val(obj[9].Tel2);
                $('#txt_RSEmail').val(obj[9].Email);

                /////รายละเอียดห้อง
                $('#ddl_RSRentType').select2("val", obj[0].DSTypeID);
                $('#ddl_RSDeveloper').select2("val", obj[0].DeveloperID);
                setTimeout(function () { $('#ddl_RSProject').select2("val", obj[0].ProjectID); }, 500);



                $('#txt_RSFloor').val(obj[3].Floor);
                $('#txt_RSUnits').val(obj[2].UnitsCode);
                $('#txt_RSAddressNo').val(obj[3].RoomNo);
                //$('#txtRoomType').val(obj[3].RoomType);
                $("#ddl_RSDS_UnitType").select2("val", obj[3].RoomType);
                $('#txt_RSRoomArea').val(obj[3].RoomArea);
                $('#txt_RSRoomAddress').val(obj[0].ProjectAddress);
                $('#txt_RSBuilding').val(obj[3].Building)

                ////Payments
                $('#txt_RSSalePrice').val(ConvertString2DecimalFormat(parseFloat(obj[8].SaleAmt).toFixed(2)));
                $('#txt_RSPricePerSQM').val(ConvertString2DecimalFormat(parseFloat(obj[8].SalePerSqm).toFixed(2)));
                $('#txt_RSNetPrice').val(ConvertString2DecimalFormat(parseFloat(obj[8].RemainingAmount).toFixed(2)));

                $('#txt_RSSaleDiscount').val(ConvertString2DecimalFormat(parseFloat(obj[4].ContractDiscount).toFixed(2)));
                $('#txt_RSTranferDiscount').val(ConvertString2DecimalFormat(parseFloat(obj[4].TransferDiscount).toFixed(2)));
                $('#txt_rSPriceBeforeVat').val(ConvertString2DecimalFormat(parseFloat(obj[4].PriceBFVat).toFixed(2)));
                $('#txt_RSVat').val(ConvertString2DecimalFormat(parseFloat(obj[4].VatAmt).toFixed(2)));
                $('#txt_RSPriceIncVat').val(ConvertString2DecimalFormat(parseFloat(obj[4].NetPrice).toFixed(2)));



                /// เงินสด
                //$('#txtReserve_RSAmountCash').val(obj[4].Pay_Cash);
                $('#txtReserve_RSAmountCash').val(ConvertString2DecimalFormat(parseFloat(obj[4].Pay_Cash).toFixed(2)));

                /// แคชเชียร์เช็ค
                //$('#txtReserve_RSAmountCashier').val(obj[4].Pay_Cashier);
                $('#txtReserve_RSAmountCashier').val(ConvertString2DecimalFormat(parseFloat(obj[4].Pay_Cashier).toFixed(2)));
                $('#ddl_RSCashierBank').select2("val", obj[4].Pay_CashierBank);
                $('#txtReserve_RSCashierNo').val(obj[4].Pay_CashierNo);
                $('#dllRNCashierDate').val(ConvertJson2DatetimeFormat2(obj[4].Pay_CashierDate, "dd/mm/yyyy"));

                /// เงินโอนผ่านธนาคาร
                //$('#txtReserve_RSAmounCashTransfer').val(obj[4].Pay_TransferCash);
                $('#txtReserve_RSAmounCashTransfer').val(ConvertString2DecimalFormat(parseFloat(obj[4].Pay_TransferCash).toFixed(2)));
                $('#txtReserve_RSBankNoCashTransfer').val(obj[4].Pay_TransferBankNo);
                $('#txtReserve_RSBankNameCashTransfer').val(formatNumber(obj[4].Pay_TransferBankName));
                $('#dllRSCashTransferDate').val(ConvertJson2DatetimeFormat2(obj[4].Pay_TransferCashDate, "dd/mm/yyyy"));


                $('#btn_RSPreviewFile').hide();
                $('#btn_RSPreviewFile2').hide();
                $('#btn_RSPreviewFile3').hide();

                LoadDataForPreview(_ReSaleID, "RS");

            });

            $('#myModalResale').modal({
                backdrop: 'static',
                keyboard: false
            });
            //$('#myModalResale').modal('show');
        }

        function LoadDataForPreview(_ID, _Type) {
            var url = '@Url.Action("GetImageTable", "DMPS_DepositRoom")';
            $.post(url,
                {
                    DepositID: _ID,
                    Type: _Type,
                }, function (result) {
                    if (result != "") {

                        if (_Type == "RS") {

                            var obj = $.parseJSON(result);

                            $.each(obj, function (a, c) {

                                if (c.Running == 1) {
                                    LoadPreview(c.Path, "btn_RSPreviewFile", "txt_RSAttachFile");
                                }

                                if (c.Running == 2) {
                                    LoadPreview(c.Path, "btn_RSPreviewFile2", "txt_RSAttachFile2");
                                }

                                if (c.Running == 3) {
                                    LoadPreview(c.Path, "btn_RSPreviewFile3", "txt_RSAttachFile3");
                                }

                                if (result != "") { }
                            });
                        }


                        if (_Type == "RT") {

                            var obj = $.parseJSON(result);

                            $.each(obj, function (a, c) {

                                if (c.Running == 1) {
                                    LoadPreview(c.Path, "btnPreviewFile", "txtAttachFile");
                                }

                                if (c.Running == 2) {
                                    LoadPreview(c.Path, "btnPreviewFile2", "txtAttachFile2");
                                }

                                if (c.Running == 3) {
                                    LoadPreview(c.Path, "btnPreviewFile3", "txtAttachFile3");
                                }

                                if (result != "") { }
                            });
                        }

                    }



                });
        }

        function LoadPreview(_FilePath, _Btn, _txt) {
            /// แนบไฟล์
            //alert(_Btn + ":" + _FilePath);

            var link = '@Url.Action("GetFile", "DMPS_DepositRoom")' + "?filename=" + _FilePath;

            if (_FilePath == null || _FilePath == "") {

                link = "";
                //$("#" + _Btn).data("link", link);
                $("#" + _Btn).hide();
            }
            else {

                $("#" + _Btn).data("link", link);
                $("#" + _Btn).show();
            }


            @*var link = '@Url.Action("GetFile", "DMPS_DepositRoom")' + "?filename=" + _FilePath;
            $('#btnPreviewFile').show();

            if (_FilePath == null || _FilePath == "") {
                link = "";
                $('#btnPreviewFile').hide();
            }
            $('#btnPreviewFile').data("link", link);*@
        }

        function ShowModalBlinding(_DepositID, _DSContactID, _UnitID, _ReservationsID, _ExistData, _CopyContact) {

            var url = '@Url.Action("GetReservationsData", "DMPS_ReservationsRoom")';

            $.post(url, {
                DepositID: _DepositID,
                DSContactID: _DSContactID,
                UnitID: _UnitID,
                ReservationsID: _ReservationsID,

            }, function (result) {
                var obj = $.parseJSON(result);
                //// :::::: หัวเอกสาร
                if (obj[4][0].ReservationsNo == "New") { $('#lblDocNo').text(GetNewDocuments(4)); }
                else { $('#lblDocNo').text(obj[4][0].ReservationsNo); }

                $('#txtDocAt').val(obj[4][0].ReservationsAt);
                $('#ddlDocDate').val(ConvertJson2DatetimeFormat2(obj[4][0].ReservationsDate, "dd/mm/yyyy"));
                $('#lblDocumentStatusDisplay').text(obj[4][0].ReservationsStatus)
                if (obj[4][0].ReservationsStatus == 0 || obj[4][0].ReservationsStatus == null) { $('#lblDocumentStatusDisplay').text("New"); }
                if (obj[4][0].ReservationsStatus == 1) { $('#lblDocumentStatusDisplay').text("ทำสัญญา (เช่า)"); }
                if (obj[4][0].ReservationsStatus == 2) { $('#lblDocumentStatusDisplay').text("ทำสัญญา (ขาย)"); }
                if (obj[4][0].ReservationsStatus == 3) { $('#lblDocumentStatusDisplay').text("จบสัญญา (เช่า)"); }
                if (obj[4][0].ReservationsStatus == 5) { $('#lblDocumentStatusDisplay').text("ยกเลิก"); }
                if (obj[4][0].ReservationsStatus == 4) { $('#lblDocumentStatusDisplay').text("จอง (เช่า)"); }
                if (obj[4][0].ReservationsStatus == 6) { $('#lblDocumentStatusDisplay').text("จอง (ซื้อ)"); }

                $('#txtDocsRef').val(obj[4][0].DocRef);
                //////0 Deposit
                //////1 Contract
                //////2 unit
                //////3 unitDetails
                //////4 rent
                //////5 BankContact
                //////6 CRM_Contact (CustType = 2 for cust Rent)

                //// Hide Data
                $('#txtDSCustomerID').val(obj[1][0].ContactsID)
                $('#txtDSID').val(obj[0][0].DepositID)
                $('#txtUnitID').val(obj[2][0].UnitsID)
                $('#txtRVCustomerID').val(obj[6][0].ContactsID)
                $('#txtRVID').val(obj[4][0].ReservationsID);

                ///////ข้อมูลผู้ให้เช่า (รายละเอียดตามบัตรประชาชน)
                $('#txtName').val(obj[1][0].NameFullPre);
                $('#txtIDCard').val(obj[1][0].CitizenID);
                $('#txtTel').val(obj[1][0].Tel1);

                /////ข้อมูลIsJuristic
                var _IsJuristic = obj[6][0].IsJuristic;
                if (_IsJuristic == true) {
                    var check = $('#rdo2').prop('checked', true);
                    if (check) {
                        $('#rdo2').prop('checked', true);
                        $('#txtNameRN').html('ชื่อบริษัท :');
                        $('#txtIDCardRN').html('ทะเบียนนิติบุคคลเลขที่  :');
                        $('#committee').show();
                    }

                }
                else if (_IsJuristic == false) {
                    $('#rdo1').prop('checked', true);
                    $('#txtNameRN').html('ชื่อ-สกุล :');
                    $('#txtIDCardRN').html('เลขที่บัตรประชาชน :');
                    $('#committee').hide();
                }



                $('#txtcommittee').val(obj[6][0].JuristicPerson);

                /////รายละเอียดบัญชีธนาคาร
                $("#ddl_Bank").select2("val", obj[5][0].BankID);
                $('#txt_AccountNo').val(obj[5][0].BankNo);
                $('#txt_AccountName').val(obj[5][0].BankName);


                /////รายละเอียดห้อง
                $('#ddl_RentType').select2("val", obj[0][0].DSTypeID);
                $('#ddl_Developer').select2("val", obj[0][0].DeveloperID);
                $('#ddl_Project').select2("val", obj[0][0].ProjectID);
                $('#txtFloor').val(obj[3][0].Floor);
                $('#txtUnits').val(obj[2][0].UnitsCode);
                $('#txtAddressNo').val(obj[3][0].RoomNo);
                $("#ddlDS_UnitType").select2("val", obj[3][0].RoomType)

                //$('#txtRoomType').val(obj[3][0].RoomType);
                $('#txtRoomArea').val(obj[3][0].RoomArea);
                $('#txtRoomAddress').val(obj[3][0].RoomAddress);
                $('#txtContractPeriod').val(obj[4][0].RentPeriod);
                $('#txtContractSdate').val(ConvertJson2DatetimeFormat2(obj[4][0].RentStartDate, "dd/mm/yyyy"));
                $('#txtContractEdate').val(ConvertJson2DatetimeFormat2(obj[4][0].RentEndDate, "dd/mm/yyyy"));
                $('#txtRoomAddress').val(obj[0][0].ProjectAddress);
                $('#txtBuilding').val(obj[3][0].Building)


                ///////ข้อมูลผู้เช่า (รายละเอียดตามบัตรประชาชน)
                $('#txtCus_Name').val(obj[6][0].NameFullPre);
                $('#txtCus_IDCard').val(obj[6][0].CitizenID);
                $('#txtCus_Age').val(obj[6][0].Age);
                $('#ddlCus_CardDate').val(ConvertJson2DatetimeFormat2(obj[6][0].CitizenIssue, "dd/mm/yyyy"));
                $('#ddlCus_CardExpire').val(ConvertJson2DatetimeFormat2(obj[6][0].CitizenExp, "dd/mm/yyyy"));
                $('#txtCus_Nationality').val(obj[6][0].Nationality);
                $('#ddlCardFrom').select2("val", obj[6][0].CitizenProvince)


                $('#ddlDueDateSignContact').val(ConvertJson2DatetimeFormat2(obj[4][0].DueDateSignContact, "dd/mm/yyyy"));

                if (obj[6][0].UnExpireIDCard == true) {
                    $('.clsChkUnExpireCard').iCheck('check');
                }
                else {
                    $('.clsChkUnExpireCard').iCheck('uncheck');
                }


                   if (obj[6][0].IsForeign == true) {
                    $('#chkRVisForeign').iCheck('check');
                }
                else {
                    $('#chkRVisForeign').iCheck('uncheck');
                }

                $('#txtCus_Address').val(obj[6][0].AddressNo);
                $('#txtCus_Moo').val(obj[6][0].Moo);
                $('#txtCus_Soi').val(obj[6][0].Soi);
                $('#txtCus_Road').val(obj[6][0].Road);

                if (obj[6][0].Province != 0) {
                    $('#ddlProvince').select2("val", obj[6][0].Province);
                    setTimeout(function () { $('#ddlDistrict').select2("val", obj[6][0].District); }, 1000);
                    setTimeout(function () { $('#ddlSubDistrict').select2("val", obj[6][0].SubDistrict); }, 1500);
                }
                else {
                    $('#ddlProvince').select2("val", "");
                    $('#ddlDistrict').select2("val", "");
                    $('#ddlSubDistrict').select2("val", "");
                }

                $('#txtCus_Zipcode').val(obj[6][0].ZipCode);
                $('#txtCus_Tel').val(obj[6][0].Tel1);
                $('#txtCus_Company').val(obj[6][0].AddressNo_Work);
                $('#txtTelCellPhone').val(obj[6][0].Tel2);
                $('#txtEmail').val(obj[6][0].Email);


                /////รายละเอียดการชำระเงินจอง เช่าห้องชุด/ซื้อห้องชุด
                $('#chkRVRent').iCheck('uncheck');
                $('#chkRVReSale').iCheck('uncheck');


                //alert(obj[4][0].ReservationsStatus);

                /// ***** Case Rent
                if (obj[4][0].ReservationsStatus == 4 || obj[4][0].ReservationsStatus == 0) {
                    $('#chkRVRent').iCheck('check');

                    $('#txtRVRentPeriod').val(obj[4][0].RentPeriod);
                    $('#dllContractSdate').val(ConvertJson2DatetimeFormat2(obj[4][0].RentStartDate, "dd/mm/yyyy"));
                    $('#dllContractEdate').val(ConvertJson2DatetimeFormat2(obj[4][0].RentEndDate, "dd/mm/yyyy"));


                    $('#txtDayOfDue').val(obj[4][0].DayofDue);

                    //$('#txtReserve_RentPrice').val(obj[4][0].RentPrice);
                    $('#txtReserve_DepositQty').val(obj[4][0].RoomDepositQty);
                    //$('#txtReserve_Deposit').val(obj[4][0].RoomDepositAmt);
                    $('#txtReserve_InsuranceQty').val(obj[4][0].RoomInsuranceQty);
                    //$('#txtReserve_InsuranceAmte').val(obj[4][0].RoomInsuranceAmt);
                    //$('#txtReserve_Amt').val(obj[4][0].ReservationsAmt);


                    $('#txtReserve_RentPrice').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].RentPrice).toFixed(2)));
                    $('#txtReserve_Deposit').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].RoomDepositAmt).toFixed(2)));
                    $('#txtReserve_InsuranceAmte').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].RoomInsuranceAmt).toFixed(2)));
                    $('#txtReserve_Amt').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].ReservationsAmt).toFixed(2)));

                    $("#pRevRent").show();
                    $("#pRevResale").hide();

                }
                    /// ***** Case Resale
                else {
                    $('#chkRVReSale').iCheck('check');

                    //alert(obj[4].DueDateSignContact);

                    $('#dllDueTransfer').val(ConvertJson2DatetimeFormat2(obj[4][0].TransferDate, "dd/mm/yyyy"));

                    //$('#txtReserve_ResalePrice').val(obj[4][0].SaleAmt);
                    //$('#txtReserve_ResalePricePerSQM').val(obj[4][0].SalePerSqm);
                    //$('#txtReserve_ResaleAmount').val(obj[4][0].ReservationsAmt);
                    //$('#txtReserve_ResaleRemainPrice').val(obj[4][0].RemainingAmount);
                    //$('#txtReserve_RSContactAmount').val(obj[4][0].ContactAmount);
                    $('#txtReserve_ResalePrice').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].SaleAmt).toFixed(2)));
                    $('#txtReserve_ResalePricePerSQM').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].SalePerSqm).toFixed(2)));
                    $('#txtReserve_ResaleAmount').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].ReservationsAmt).toFixed(2)));
                    $('#txtReserve_ResaleRemainPrice').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].RemainingAmount).toFixed(2)));
                    $('#txtReserve_RSContactAmount').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].ContactAmount).toFixed(2)));



                    $("#pRevResale").show();
                    $("#pRevRent").hide();
                }


                //// ******* ประเภทการชำระเงินจอง เช่าห้องชุด/ซื้อห้องชุด

                /// เงินสด
                //$('#txtReserve_AmountCash').val(formatNumber(obj[4][0].Pay_Cash));
                $('#txtReserve_AmountCash').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].Pay_Cash).toFixed(2)));

                /// แคชเชียร์เช็ค
                //$('#txtReserve_AmountCashier').val(formatNumber(obj[4][0].Pay_Cashier));
                $('#txtReserve_AmountCashier').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].Pay_Cashier).toFixed(2)));

                $('#ddl_CashierBank').select2("val", obj[4][0].Pay_CashierBank);
                $('#txtReserve_CashierNo').val(obj[4][0].Pay_CashierNo);
                $('#dllCashierDate').val(ConvertJson2DatetimeFormat2(obj[4][0].Pay_CashierDate, "dd/mm/yyyy"));

                /// เงินโอนผ่านธนาคาร
                //$('#txtReserve_AmounCashTransfer').val(formatNumber(obj[4][0].Pay_TransferCash));
                $('#txtReserve_AmounCashTransfer').val(ConvertString2DecimalFormat(parseFloat(obj[4][0].Pay_TransferCash).toFixed(2)));

                $('#txtReserve_BankNoCashTransfer').val(obj[4][0].Pay_TransferBankNo);
                $('#txtReserve_BankNameCashTransfer').val(obj[4][0].Pay_TransferBankName);
                $('#dllCashTransferDate').val(ConvertJson2DatetimeFormat2(obj[4][0].Pay_TransferCashDate, "dd/mm/yyyy"));


                //// ******* หมายเหตุ
                $('#txtRemark').val(obj[4][0].Remark);



                $('#btnRV_Save').hide();
                $('#btnRV_Print').hide();
                $('#btnRv_Cancel').hide();

                if (obj[4][0].ReservationsNo == "New") {
                    $('#btnRV_Save').show();
                    $('#btnRV_Print').show();
                    $('#btnRv_Cancel').hide();

                }

                if (obj[4][0].ReservationsNo != "New") {


                    if (obj[4][0].IsCancel == true || obj[4][0].IsContact == true || obj[4][0].IsDelete == true) {
                        $('#btnRV_Save').hide();
                        $('#btnRV_Print').hide();
                        $('#btnRv_Cancel').hide();
                    }

                    if (obj[4][0].IsCancel == false && obj[4][0].IsContact == false && obj[4][0].IsDelete == false) {
                        $('#btnRV_Save').show();
                        $('#btnRV_Print').show();
                        $('#btnRv_Cancel').show();
                    }
                }

                //else  {
                //    $('#btnRV_Save').hide();
                //    $('#btnRV_Print').hide();
                //    $('#btnRv_Cancel').hide();
                //}
                //else {


                //    $('#btnRV_Save').show();
                //    $('#btnRV_Print').show();
                //    $('#btnRV_Cancel').show();
                //}


            });

            //$('#myModal').modal('show');

            LoadShopDateils(_ReservationsID);

            $('#myModal').modal({
                backdrop: 'static',
                keyboard: false
            });
        }




        /*======================================================= Loading ========================================================*/
        function ShowHideLoading(_isShow) {
            if (_isShow == 1) {
                $('body').waitMe({
                    effect: 'progressBar',
                    text: 'Please wait..',
                    color: '#000',
                    maxSize: '',
                    waitTime: -1,
                    textPos: 'vertical',
                });
            } else {
                $('body').waitMe("hide");
            }
        }
        /*======================================================= End Loading ========================================================*/


    });
</script>
