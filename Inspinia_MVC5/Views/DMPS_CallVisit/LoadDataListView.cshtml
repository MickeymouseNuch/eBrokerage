@using System.Data;

<div class="wrapper wrapper-content animated fadeIn" style="padding-top:0px">
    <div class="row">
        <div class="col-lg-12">
            <ul class="nav nav-tabs">
                <li class="tabshow " data-tab="Lead" id="Lead"><a data-toggle="tab">รายการ Lead </a></li>
                <li class="tabshow " data-tab="Call" id="Call"><a data-toggle="tab">รายการ Calls </a></li>
                <li class="tabshow" data-tab="Walk" id="Walk"><a data-toggle="tab">รายการ Walk-in</a></li>
            </ul>


            <div class="ibox float-e-margins">
                <div class="ibox-content">

                    @{
                        var IsshowTab = ViewBag.IsshowTab;
                        var i = 0;

                        if (IsshowTab == "Lead")
                        {
                            <table id="tbLead" class="table table-striped table-bordered table-hover dataTables-example dataTableLead" style="width: 2000px;">
                                <thead>
                                    <tr>
                                        <th style="text-align: center; padding-top: 20px;">No.</th>
                                        <th></th>
                                        <th style="width: 150px; text-align: center; padding-top: 20px;">ชื่อ</th>
                                        <th style="width: 150px; text-align: center; padding-top: 20px;">นามสกุล</th>
                                        <th style="width: 150px; text-align: center; padding-top: 20px;">เลขที่บัตร</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">เบอร์โทร</th>
                                        <th style="width: 200px; text-align: center; padding-top: 20px;">E-mail Address และ ID LINE</th>
                                        <th style="width: 450px; text-align: center; padding-top: 20px;">ที่อยู่</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">วันที่ติดต่อล่าสุด</th>
                                        <th style="width: 150px; text-align: center; padding-top: 20px;">พนักงานขาย</th>
                                    </tr>
                                </thead>
                                <tbody>

                                    @foreach (Inspinia_MVC5.Models.DMPS.vw_LeadCallVisit item in ViewBag.lstLeads)
                                    {
                                    <tr class="IsRows" data-id="@item.CreateDateTime">
                                        <td class="text-right">  @(i + 1)</td>
                                        <td class="text-center">
                                            <button data-id="@item.CallVisitID" class="confirm-View btnVED btn-primary" type="button" title="แสดงข้อมูล"><i class="fa fa-search"></i></button>
                                        </td>

                                        <td style="width: 150px; "> @item.Name  </td>
                                        <td style="width: 150px; "> @item.SurName  </td>
                                        <td style="width: 150px; text-align: center; "> @item.IDCard  </td>
                                        <td style="width: 100px; text-align: center; "> @(item.Tel != "" ? "ˑ" + item.Tel : "")  </td>
                                        <td style="width: 200px; text-align: center; "> @(item.Email != "" && item.LineID !="" ? item.Email + " , " + item.LineID : item.Email == "" && item.LineID != "" ? item.LineID : item.Email != "" && item.LineID == "" ? item.Email : "" )</td>
                                        <td style="width: 450px; "> @(item.FullAddress != null ? item.FullAddress : item.Address )  </td>
                                        <td style="width: 100px; text-align: center;"> @(item.LastActivityDate != null ? ((DateTime)item.LastActivityDate).ToString("dd/MM/yyyy") : "") </td>
                                        <td style="width: 150px; "> @item.SaleName  </td>

                                    </tr>
                                        i++;
                                    }

                                </tbody>
                                <tfoot>
                                    <tr></tr>
                                </tfoot>
                            </table>

                        }

                        if (IsshowTab == "Call")
                        {
                            <table id="tbCall" class="table table-striped table-bordered table-hover dataTables-example dataTableCall" style="width: 2000px;">
                                <thead>
                                    <tr>
                                        <th style="text-align: center; padding-top: 20px;">No.</th>
                                        <!--<th></th>-->
                                        <th style="width: 200px; text-align: center; padding-top: 20px;">Project</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">วันที่โทร</th>
                                        <th style="width: 110px; text-align: center; padding-top: 20px;">โทรติดตามครั้งที่ 1</th>
                                        <th style="width: 110px; text-align: center; padding-top: 20px;">โทรติดตามครั้งที่ 2</th>
                                        <th style="width: 110px; text-align: center; padding-top: 20px;">โทรติดตามครั้งที่ 3</th>
                                        <th style="width: 110px; text-align: center; padding-top: 20px;">ปิดการติดตาม (เช่าแล้ว)</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">ปิดการติดตาม (เช่าที่อื่นแล้ว)</th>
                                        <th style="width: 150px; text-align: center; padding-top: 20px;">ชื่อ</th>
                                        <th style="width: 150px; text-align: center; padding-top: 20px;">นามสกุล</th>
                                        <th style="width: 150px; text-align: center; padding-top: 20px;">เลขที่บัตร</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">เบอร์โทร</th>
                                        <th style="width: 200px; text-align: center; padding-top: 20px;">E-mail Address และ ID LINE</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">บริษัท</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">ตำแหน่ง</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">อำเภอ/เขต </th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">จังหวัด </th>
                                        <th style="width: 150px; text-align: center; padding-top: 20px;">สื่อที่ทราบข่าว</th>
                                        <th style="width: 60px; text-align: center; padding-top: 20px;">สถานะ</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">อายุ (ปี)</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">อาชีพ</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">รายได้ต่อเดือน (บาท)</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">งบประมาณในการเช่าชุด (บาท/เดือน)</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">วัตถุประสงค์หลักในการเช่า</th>
                                        <th style="width: 150px; text-align: center; padding-top: 20px;">เหตุผลที่ยังไม่ตัดสินใจ</th>
                                        <th style="width: 150px; text-align: center; padding-top: 20px;">โครงการที่เปรียบเทียบ</th>
                                        <th style="width: 250px; text-align: center; padding-top: 20px;">รายละเอียดลูกค้า</th>
                                    </tr>
                                </thead>
                                <tbody>

                                    @foreach (Inspinia_MVC5.Models.DMPS.sp_MainCallVisit_Result item in ViewBag.lstCalls)
                                    {
                                    <tr class="IsRows" data-id="@item.CreateDateTime">
                                        <td class="text-right">  @(i + 1)</td>
                                        <!-- <td class="text-center">
                                             <button data-id="@item.CallVisitID" class="confirm-View btnVED btn-primary" type="button" title="แสดงข้อมูล"><i class="fa fa-search"></i></button>
                                         </td>-->

                                        <td> @item.ProjectName </td>

                                        <td style="width: 100px; text-align: center; "> @(item.Call1 != null ? ((DateTime)item.Call1).ToString("dd/MM/yyyy") : "") </td>
                                        <td style="width: 100px; text-align: center; "> @(item.Call2 != null ? ((DateTime)item.Call2).ToString("dd/MM/yyyy") : "")</td>
                                        <td style="width: 100px; text-align: center; "> @(item.Call3 != null ? ((DateTime)item.Call3).ToString("dd/MM/yyyy") : "") </td>
                                        <td style="width: 100px; text-align: center; "> @(item.Call4 != null ? ((DateTime)item.Call4).ToString("dd/MM/yyyy") : "") </td>
                                        <td style="width: 100px; text-align: center; "> @(item.Colsed1 != null ? ((DateTime)item.Colsed1).ToString("dd/MM/yyyy") : "")  </td>
                                        <td style="width: 100px; text-align: center; "> @(item.Colsed2 != null ? ((DateTime)item.Colsed2).ToString("dd/MM/yyyy") : "") </td>
                                        <td style="width: 100px; "> @item.Name  </td>
                                        <td style="width: 100px; "> @item.SurName  </td>
                                        <td style="width: 100px; "> @item.IDCard  </td>
                                        <td style="width: 100px; text-align: center; "> @(item.Tel != "" ? "ˑ" + item.Tel : "")  </td>
                                        <td style="width: 100px; text-align: center; "> @(item.Email != "" && item.LineID !="" ? item.Email + " , " + item.LineID : item.Email == "" && item.LineID != "" ? item.LineID : item.Email != "" && item.LineID == "" ? item.Email : "" )</td>
                                        <td style="width: 100px; "> @item.CompanyName  </td>
                                        <td style="width: 100px; "> @item.CompanyPosition  </td>
                                        <td style="width: 100px; "> @item.CompanyDistrictName  </td>
                                        <td style="width: 100px; "> @item.CompanyProvinceName  </td>
                                        <td style="width: 100px; "> @item.MediaName  </td>
                                        <td style="width: 60px; text-align: center; "> @item.MaritalStatusName  </td>
                                        <td style="width: 100px; text-align: center; "> @item.AgeRange  </td>
                                        <td style="width: 100px; text-align: center; "> @item.OccupationName  </td>
                                        <td style="width: 100px; text-align: center; "> @item.SalaryRange  </td>
                                        <td style="width: 100px; text-align: center; "> @item.BudgetRange  </td>
                                        <td style="width: 100px; text-align: center; "> @item.PurposeName  </td>
                                        <td style="width: 100px; text-align: center; "> @item.ReasonName  </td>
                                        <td style="width: 100px; text-align: center; "> @item.CompareProjectName  </td>
                                        <td style="width: 100px; "> @item.ActivityDetails  </td>

                                    </tr>
                                        i++;
                                    }

                                </tbody>
                                <tfoot>
                                    <tr></tr>
                                </tfoot>
                            </table>

                        }


                        if (IsshowTab == "Walk")
                        {

                            <table id="tbWalk" class="table table-striped table-bordered table-hover dataTables-example dataTableWalk" style="width:2000px">
                                <thead>
                                    <tr>
                                        <th style="text-align: center; padding-top: 20px;">No.</th>
                                        <!--<th></th>-->
                                        <th style="width: 200px; text-align: center; padding-top: 20px;">Project</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">Visit Date</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">Re-Visit</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">ปิดการติดตาม (เช่าแล้ว)</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">ปิดการติดตาม (เช่าที่อื่นแล้ว)</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">ชื่อ</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">นามสกุล</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">เลขที่บัตร</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">เบอร์โทร</th>
                                        <th style="width: 200px; text-align: center; padding-top: 20px;">E-mail Address และ ID LINE</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">บริษัท</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">ตำแหน่ง</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">อำเภอ/เขต </th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">จังหวัด </th>
                                        <th style="width: 150px; text-align: center; padding-top: 20px;">สื่อที่ทราบข่าว</th>
                                        <th style="width: 60px; text-align: center; padding-top: 20px;">สถานะ</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">อายุ (ปี)</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">อาชีพ</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">รายได้ต่อเดือน (บาท)</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">งบประมาณในการเช่าชุด (บาท/เดือน)</th>
                                        <th style="width: 100px; text-align: center; padding-top: 20px;">วัตถุประสงค์หลักในการเช่า</th>
                                        <th style="width: 150px; text-align: center; padding-top: 20px;">เหตุผลที่ยังไม่ตัดสินใจ</th>
                                        <th style="width: 150px; text-align: center; padding-top: 20px;">โครงการที่เปรียบเทียบ</th>
                                        <th style="width: 80px; text-align: center; padding-top: 20px;">ใบยินยอม 1</th>
                                        <th style="width: 80px; text-align: center; padding-top: 20px;">ใบยินยอม 2</th>
                                        <th style="width: 80px; text-align: center; padding-top: 20px;">ใบยินยอม 3</th>
                                        <th style="width: 80px; text-align: center; padding-top: 20px;">ไม่ยินยอม</th>
                                        <th style="width: 250px; text-align: center; padding-top: 20px;">รายละเอียดลูกค้า</th>
                                    </tr>
                                </thead>

                                <tbody>

                                    @foreach (Inspinia_MVC5.Models.DMPS.sp_MainCallVisit_Result item in ViewBag.lstWalks)
                                    {
                                    <tr class="IsRows" data-id="@item.CreateDateTime">
                                        <td class="text-right">  @(i + 1)</td>
                                        <!--<td class="text-center">
                                            <button data-id="@item.CallVisitID" class="confirm-View btnVED btn-primary" type="button" title="แสดงข้อมูล"><i class="fa fa-search"></i></button>
                                            </td>-->

                                        <td> @item.ProjectName </td>
                                        <td style="width: 100px; text-align: center; "> @(item.Visit1 != null ? ((DateTime)item.Visit1).ToString("dd/MM/yyyy") : "") </td>
                                        <td style="width: 100px; text-align: center; "> @(item.Visit2 != null ? ((DateTime)item.Visit2).ToString("dd/MM/yyyy") : "")</td>
                                        <td style="width: 100px; text-align: center; "> @(item.Colsed1 != null ? ((DateTime)item.Colsed1).ToString("dd/MM/yyyy") : "") </td>
                                        <td style="width: 100px; text-align: center; "> @(item.Colsed2 != null ? ((DateTime)item.Colsed2).ToString("dd/MM/yyyy") : "")</td>
                                        <td style="width: 100px; "> @item.Name  </td>
                                        <td style="width: 100px; "> @item.SurName  </td>
                                        <td style="width: 100px; text-align: center; "> @item.IDCard </td>
                                        <td style="width: 100px; text-align: center; "> @(item.Tel != "" ? "ˑ" + item.Tel : "") </td>
                                        <td style="width: 100px; text-align: center; ">  @( item.Email != ""  ? item.Email : "")  @( item.Email != "" && item.LineID != "" ? "," : "") @( item.LineID != "" ? item.LineID : "") </td>
                                        <td style="width: 100px; "> @item.CompanyName  </td>
                                        <td style="width: 100px; "> @item.CompanyPosition  </td>
                                        <td style="width: 100px; "> @item.CompanyDistrictName  </td>
                                        <td style="width: 100px; "> @item.CompanyProvinceName  </td>
                                        <td style="width: 100px; "> @item.MediaName  </td>
                                        <td style="width: 60px; text-align: center;"> @item.MaritalStatusName  </td>
                                        <td style="width: 100px; text-align: center; "> @item.AgeRange  </td>
                                        <td style="width: 100px; text-align: center; "> @item.OccupationName  </td>
                                        <td style="width: 100px; text-align: center; "> @item.SalaryRange  </td>
                                        <td style="width: 100px; text-align: center; "> @item.BudgetRange  </td>
                                        <td style="width: 100px; text-align: center; "> @item.PurposeName  </td>
                                        <td style="width: 100px; text-align: center; "> @item.ReasonName  </td>
                                        <td style="width: 100px; text-align: center; "> @item.CompareProjectName  </td>
                                        <td style="width: 80px; text-align: center; "> @item.Agree1 </td>
                                        <td style="width: 80px; text-align: center; "> @item.Agree2 </td>
                                        <td style="width: 80px; text-align: center; "> @item.Agree3 </td>
                                        <td style="width: 80px; text-align: center; "> @item.Disagree </td>
                                        <td style="width: 100px; "> @item.ActivityDetails  </td>

                                    </tr>
                                        i++;
                                    }



                                </tbody>


                                <tfoot>
                                    <tr></tr>
                                </tfoot>
                            </table>

                        }

                    }
                </div>
            </div>
        </div>
    </div>
</div>



